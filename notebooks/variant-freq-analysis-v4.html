<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.547">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Analysis v4</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="variant-freq-analysis-v4_files/libs/clipboard/clipboard.min.js"></script>
<script src="variant-freq-analysis-v4_files/libs/quarto-html/quarto.js"></script>
<script src="variant-freq-analysis-v4_files/libs/quarto-html/popper.min.js"></script>
<script src="variant-freq-analysis-v4_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="variant-freq-analysis-v4_files/libs/quarto-html/anchor.min.js"></script>
<link href="variant-freq-analysis-v4_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="variant-freq-analysis-v4_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="variant-freq-analysis-v4_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="variant-freq-analysis-v4_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="variant-freq-analysis-v4_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Analysis v4</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="analysis-v4" class="level2">
<h2 class="anchored" data-anchor-id="analysis-v4">Analysis v4</h2>
<div id="cell-1" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> textwrap</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> natsort <span class="im">import</span> index_natsorted</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="calculating-the-variance-of-the-af-and-fps-values" class="level3">
<h3 class="anchored" data-anchor-id="calculating-the-variance-of-the-af-and-fps-values">Calculating the Variance of the AF and FPS values</h3>
<p>It would be quite interesting to see if for each variant site per motif, the variance of the AF and FPS values are correlated.</p>
<p>I.e. if a variant site has a high variance in AF values, does it also have a high variance in FPS values?</p>
<p>First, load the data file as dataframe and then truncate the columns to include on AF and FPS data. Next, convert the dataframe into long format.</p>
<div id="cell-4" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import the data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># filepath = '/home/users/ntu/suffiazi/scratch/outputs/tmp/input_data/E2F5_E2F5_HUMAN.H11MO.0.B_fpscore-af-varsites-combined-matrix-wide.tsv'</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>filepath <span class="op">=</span> <span class="st">'/home/msazizan/hyperspace/gatk-workflow/plotting/output-data/combined_matrix/E2F5_E2F5_HUMAN.H11MO.0.B_fpscore-af-varsites-combined-matrix-wide.tsv'</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>matrix_afps <span class="op">=</span> pd.read_csv(filepath, sep<span class="op">=</span><span class="st">'</span><span class="ch">\t</span><span class="st">'</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># extract motif id from filename</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>motif_id <span class="op">=</span> os.path.basename(filepath).replace(<span class="st">'_fpscore-af-varsites-combined-matrix-wide.tsv'</span>, <span class="st">''</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>motif_id</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>'E2F5_E2F5_HUMAN.H11MO.0.B'</code></pre>
</div>
</div>
<div id="cell-5" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>matrix_afps.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Chromosome</th>
<th data-quarto-table-cell-role="th">Start</th>
<th data-quarto-table-cell-role="th">End</th>
<th data-quarto-table-cell-role="th">98JKPD8_lumA_fps</th>
<th data-quarto-table-cell-role="th">ANAB5F7_basal_fps</th>
<th data-quarto-table-cell-role="th">S6R691V_her2_fps</th>
<th data-quarto-table-cell-role="th">PU24GB8_lumB_fps</th>
<th data-quarto-table-cell-role="th">2GAMBDQ_norm_fps</th>
<th data-quarto-table-cell-role="th">2GAMBDQ_norm_varsite_pos</th>
<th data-quarto-table-cell-role="th">2GAMBDQ_norm_ref_allele</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">ANAB5F7_basal_AF</th>
<th data-quarto-table-cell-role="th">PU24GB8_lumB_varsite_pos</th>
<th data-quarto-table-cell-role="th">PU24GB8_lumB_ref_allele</th>
<th data-quarto-table-cell-role="th">PU24GB8_lumB_alt_allele</th>
<th data-quarto-table-cell-role="th">PU24GB8_lumB_AF</th>
<th data-quarto-table-cell-role="th">S6R691V_her2_varsite_pos</th>
<th data-quarto-table-cell-role="th">S6R691V_her2_ref_allele</th>
<th data-quarto-table-cell-role="th">S6R691V_her2_alt_allele</th>
<th data-quarto-table-cell-role="th">S6R691V_her2_AF</th>
<th data-quarto-table-cell-role="th">region_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>chr1</td>
<td>905473</td>
<td>905483</td>
<td>0.10260</td>
<td>0.12218</td>
<td>0.13921</td>
<td>0.12024</td>
<td>0.14062</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>0.000000</td>
<td>905474.0</td>
<td>G</td>
<td>A</td>
<td>0.027778</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.000000</td>
<td>chr1:905473-905483</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>chr1</td>
<td>925405</td>
<td>925415</td>
<td>0.09540</td>
<td>0.03670</td>
<td>0.09011</td>
<td>0.05082</td>
<td>0.05586</td>
<td>925409.0</td>
<td>T</td>
<td>...</td>
<td>0.730769</td>
<td>925409.0</td>
<td>T</td>
<td>C</td>
<td>0.769231</td>
<td>925409.0</td>
<td>T</td>
<td>C</td>
<td>0.730769</td>
<td>chr1:925405-925415</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>chr1</td>
<td>1020750</td>
<td>1020760</td>
<td>0.09749</td>
<td>0.09080</td>
<td>0.07864</td>
<td>0.10880</td>
<td>0.08458</td>
<td>1020755.0</td>
<td>C</td>
<td>...</td>
<td>0.000000</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.000000</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.000000</td>
<td>chr1:1020750-1020760</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>chr1</td>
<td>1130413</td>
<td>1130423</td>
<td>0.11471</td>
<td>0.04786</td>
<td>0.11338</td>
<td>0.14384</td>
<td>0.15151</td>
<td>1130420.0</td>
<td>C</td>
<td>...</td>
<td>0.062500</td>
<td>1130420.0</td>
<td>C</td>
<td>T</td>
<td>0.131579</td>
<td>1130420.0</td>
<td>C</td>
<td>T</td>
<td>0.147059</td>
<td>chr1:1130413-1130423</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>chr1</td>
<td>1225277</td>
<td>1225287</td>
<td>0.01792</td>
<td>0.04624</td>
<td>0.02729</td>
<td>0.01957</td>
<td>0.02657</td>
<td>1225285.0</td>
<td>G</td>
<td>...</td>
<td>0.062500</td>
<td>1225285.0</td>
<td>G</td>
<td>A</td>
<td>0.078947</td>
<td>1225285.0</td>
<td>G</td>
<td>A</td>
<td>0.088235</td>
<td>chr1:1225277-1225287</td>
</tr>
</tbody>
</table>

<p>5 rows × 29 columns</p>
</div>
</div>
</div>
<p>Let’s filter the loaded table to include only the <code>_AF</code> and <code>_fps</code> columns, as well as the <code>region_id</code> column.</p>
<div id="cell-7" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>afps_df <span class="op">=</span> matrix_afps.<span class="bu">filter</span>(regex<span class="op">=</span><span class="st">'_AF$|_fps$|_id$'</span>).copy()</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>afps_df.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">98JKPD8_lumA_fps</th>
<th data-quarto-table-cell-role="th">ANAB5F7_basal_fps</th>
<th data-quarto-table-cell-role="th">S6R691V_her2_fps</th>
<th data-quarto-table-cell-role="th">PU24GB8_lumB_fps</th>
<th data-quarto-table-cell-role="th">2GAMBDQ_norm_fps</th>
<th data-quarto-table-cell-role="th">2GAMBDQ_norm_AF</th>
<th data-quarto-table-cell-role="th">98JKPD8_lumA_AF</th>
<th data-quarto-table-cell-role="th">ANAB5F7_basal_AF</th>
<th data-quarto-table-cell-role="th">PU24GB8_lumB_AF</th>
<th data-quarto-table-cell-role="th">S6R691V_her2_AF</th>
<th data-quarto-table-cell-role="th">region_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.10260</td>
<td>0.12218</td>
<td>0.13921</td>
<td>0.12024</td>
<td>0.14062</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.027778</td>
<td>0.000000</td>
<td>chr1:905473-905483</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.09540</td>
<td>0.03670</td>
<td>0.09011</td>
<td>0.05082</td>
<td>0.05586</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.730769</td>
<td>0.769231</td>
<td>0.730769</td>
<td>chr1:925405-925415</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.09749</td>
<td>0.09080</td>
<td>0.07864</td>
<td>0.10880</td>
<td>0.08458</td>
<td>0.062500</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>chr1:1020750-1020760</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.11471</td>
<td>0.04786</td>
<td>0.11338</td>
<td>0.14384</td>
<td>0.15151</td>
<td>0.250000</td>
<td>0.181818</td>
<td>0.062500</td>
<td>0.131579</td>
<td>0.147059</td>
<td>chr1:1130413-1130423</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.01792</td>
<td>0.04624</td>
<td>0.02729</td>
<td>0.01957</td>
<td>0.02657</td>
<td>0.071429</td>
<td>0.090909</td>
<td>0.062500</td>
<td>0.078947</td>
<td>0.088235</td>
<td>chr1:1225277-1225287</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-8" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to long format</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>afps_df_long <span class="op">=</span> afps_df.melt(id_vars<span class="op">=</span>[<span class="st">"region_id"</span>], var_name<span class="op">=</span><span class="st">"variable"</span>, value_name<span class="op">=</span><span class="st">"value"</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># split the variable column into sample_id and type columns using reverse split string method, which returns a dataframe of columns based on the number of splits (n=x); this can directly be assigned to new columns in the original dataframe</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>afps_df_long[[<span class="st">'sample_id'</span>, <span class="st">'type'</span>]] <span class="op">=</span> afps_df_long[<span class="st">'variable'</span>].<span class="bu">str</span>.rsplit(<span class="st">'_'</span>, n<span class="op">=</span><span class="dv">1</span>, expand<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># drop the redundant 'variable' column</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>afps_df_long <span class="op">=</span> afps_df_long.drop(columns<span class="op">=</span>[<span class="st">"variable"</span>])</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co"># now pivot the dataframe to create new columns based on the type column</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>afps_df_lpv <span class="op">=</span> afps_df_long.pivot(index<span class="op">=</span>[<span class="st">'region_id'</span>, <span class="st">'sample_id'</span>], columns<span class="op">=</span><span class="st">'type'</span>, values<span class="op">=</span><span class="st">'value'</span>).reset_index()</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co"># remove the index name and rename the columns to match the type values</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>afps_df_lpv <span class="op">=</span> afps_df_lpv.rename_axis(<span class="va">None</span>, axis<span class="op">=</span><span class="dv">1</span>).rename(columns<span class="op">=</span>{<span class="st">'fps'</span>: <span class="st">'FPS'</span>})</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co"># sort the dataframe by region_id naturally</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>afps_df_lpv <span class="op">=</span> afps_df_lpv.reindex(index<span class="op">=</span>index_natsorted(afps_df_lpv[<span class="st">'region_id'</span>]))</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>afps_df_lpv <span class="op">=</span> afps_df_lpv.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>afps_df_lpv</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">region_id</th>
<th data-quarto-table-cell-role="th">sample_id</th>
<th data-quarto-table-cell-role="th">AF</th>
<th data-quarto-table-cell-role="th">FPS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>chr1:905473-905483</td>
<td>2GAMBDQ_norm</td>
<td>0.000000</td>
<td>0.14062</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>chr1:905473-905483</td>
<td>98JKPD8_lumA</td>
<td>0.000000</td>
<td>0.10260</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>chr1:905473-905483</td>
<td>ANAB5F7_basal</td>
<td>0.000000</td>
<td>0.12218</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>chr1:905473-905483</td>
<td>PU24GB8_lumB</td>
<td>0.027778</td>
<td>0.12024</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>chr1:905473-905483</td>
<td>S6R691V_her2</td>
<td>0.000000</td>
<td>0.13921</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10920</td>
<td>chrX:150849074-150849084</td>
<td>2GAMBDQ_norm</td>
<td>0.750000</td>
<td>0.20522</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10921</td>
<td>chrX:150849074-150849084</td>
<td>98JKPD8_lumA</td>
<td>0.500000</td>
<td>0.34392</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10922</td>
<td>chrX:150849074-150849084</td>
<td>ANAB5F7_basal</td>
<td>0.600000</td>
<td>0.07363</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10923</td>
<td>chrX:150849074-150849084</td>
<td>PU24GB8_lumB</td>
<td>0.605263</td>
<td>0.24735</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10924</td>
<td>chrX:150849074-150849084</td>
<td>S6R691V_her2</td>
<td>0.588235</td>
<td>0.35995</td>
</tr>
</tbody>
</table>

<p>10925 rows × 4 columns</p>
</div>
</div>
</div>
<div id="cell-9" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># afps_df_lpv[afps_df_lpv['sample_id'] == '2GAMBDQ_norm'].describe()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="affps-matrix" class="level3">
<h3 class="anchored" data-anchor-id="affps-matrix">AF–FPS Matrix</h3>
<p>At this point, we now have both a matrix of AF and FPS values in wide form (<code>afps_df</code>) and the same dataset in long form (<code>afps_df_lpv</code>). We can scale the FPS values to be between 0 and 1 now.</p>
<div id="cell-11" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use MinMaxScaler to scale the raw fps values to range between 0 and 1</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> MinMaxScaler</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># scale the FPS values to a range of 0-1</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize a MinMaxScaler</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> MinMaxScaler()</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># copy df</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>fps_df_scaled <span class="op">=</span> matrix_afps.<span class="bu">filter</span>(regex<span class="op">=</span><span class="st">'_fps$|_id$'</span>).copy()</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># set the index to 'region_id'</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>fps_df_scaled <span class="op">=</span> fps_df_scaled.set_index(<span class="st">'region_id'</span>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the MinMaxScaler to the 'FPS' column and transform it</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>fps_df_scaled <span class="op">=</span> pd.DataFrame(scaler.fit_transform(fps_df_scaled), columns<span class="op">=</span>fps_df_scaled.columns, index<span class="op">=</span>fps_df_scaled.index)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="co"># rename columns by adding '_scaled' to the column names</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>fps_df_scaled <span class="op">=</span> fps_df_scaled.add_suffix(<span class="st">'_scaled'</span>)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>fps_df_scaled</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">98JKPD8_lumA_fps_scaled</th>
<th data-quarto-table-cell-role="th">ANAB5F7_basal_fps_scaled</th>
<th data-quarto-table-cell-role="th">S6R691V_her2_fps_scaled</th>
<th data-quarto-table-cell-role="th">PU24GB8_lumB_fps_scaled</th>
<th data-quarto-table-cell-role="th">2GAMBDQ_norm_fps_scaled</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">region_id</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">chr1:905473-905483</td>
<td>0.045183</td>
<td>0.062660</td>
<td>0.069304</td>
<td>0.056307</td>
<td>0.065892</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">chr1:925405-925415</td>
<td>0.042012</td>
<td>0.018821</td>
<td>0.044860</td>
<td>0.023798</td>
<td>0.026175</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">chr1:1020750-1020760</td>
<td>0.042933</td>
<td>0.046566</td>
<td>0.039150</td>
<td>0.050950</td>
<td>0.039632</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">chr1:1130413-1130423</td>
<td>0.050516</td>
<td>0.024545</td>
<td>0.056445</td>
<td>0.067359</td>
<td>0.070994</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">chr1:1225277-1225287</td>
<td>0.007892</td>
<td>0.023714</td>
<td>0.013586</td>
<td>0.009164</td>
<td>0.012450</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">chrX:118300271-118300281</td>
<td>0.003096</td>
<td>0.005052</td>
<td>0.002768</td>
<td>0.002861</td>
<td>0.004264</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">chrX:119211181-119211191</td>
<td>0.005351</td>
<td>0.006087</td>
<td>0.005103</td>
<td>0.006397</td>
<td>0.006813</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">chrX:139342109-139342119</td>
<td>0.008878</td>
<td>0.004262</td>
<td>0.010728</td>
<td>0.007750</td>
<td>0.010121</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">chrX:147508113-147508123</td>
<td>0.003567</td>
<td>0.003246</td>
<td>0.003470</td>
<td>0.002946</td>
<td>0.006865</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">chrX:150849074-150849084</td>
<td>0.151456</td>
<td>0.037761</td>
<td>0.179197</td>
<td>0.115831</td>
<td>0.096162</td>
</tr>
</tbody>
</table>

<p>2185 rows × 5 columns</p>
</div>
</div>
</div>
<p>Now we should convert the FPS scaled dataframe into long form.</p>
<div id="cell-13" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reset index</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>fps_df_scaled_long <span class="op">=</span> fps_df_scaled.reset_index()</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to long format</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>fps_df_scaled_long <span class="op">=</span> fps_df_scaled_long.melt(id_vars<span class="op">=</span>[<span class="st">"region_id"</span>], var_name<span class="op">=</span><span class="st">"variable"</span>, value_name<span class="op">=</span><span class="st">"value"</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># split the variable column into sample_id and type columns using reverse split string method, which returns a dataframe of columns based on the number of splits (n=x); this can directly be assigned to new columns in the original dataframe</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the 'variable' column into three parts</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>fps_df_scaled_long[[<span class="st">'part1'</span>, <span class="st">'part2'</span>, <span class="st">'part3'</span>]] <span class="op">=</span> fps_df_scaled_long[<span class="st">'variable'</span>].<span class="bu">str</span>.rsplit(<span class="st">'_'</span>, n<span class="op">=</span><span class="dv">2</span>, expand<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign part1 to 'sample_id' and concatenate the other parts to form 'type'</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>fps_df_scaled_long[<span class="st">'sample_id'</span>] <span class="op">=</span> fps_df_scaled_long[<span class="st">'part1'</span>]</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>fps_df_scaled_long[<span class="st">'type'</span>] <span class="op">=</span> fps_df_scaled_long[<span class="st">'part2'</span>].<span class="bu">str</span>.upper() <span class="op">+</span> <span class="st">'_'</span> <span class="op">+</span> fps_df_scaled_long[<span class="st">'part3'</span>]</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop the unnecessary columns</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>fps_df_scaled_long <span class="op">=</span> fps_df_scaled_long.drop([<span class="st">'variable'</span>, <span class="st">'part1'</span>, <span class="st">'part2'</span>, <span class="st">'part3'</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co"># now pivot the dataframe to create new columns based on the type column</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>fps_df_scaled_lpv <span class="op">=</span> fps_df_scaled_long.pivot(index<span class="op">=</span>[<span class="st">'region_id'</span>, <span class="st">'sample_id'</span>], columns<span class="op">=</span><span class="st">'type'</span>, values<span class="op">=</span><span class="st">'value'</span>).reset_index()</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="co"># remove the index name and rename the columns to match the type values</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>fps_df_scaled_lpv <span class="op">=</span> fps_df_scaled_lpv.rename_axis(<span class="va">None</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="co"># sort the dataframe by region_id naturally</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>fps_df_scaled_lpv <span class="op">=</span> fps_df_scaled_lpv.reindex(index<span class="op">=</span>index_natsorted(fps_df_scaled_lpv[<span class="st">'region_id'</span>]))</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>fps_df_scaled_lpv <span class="op">=</span> fps_df_scaled_lpv.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>fps_df_scaled_lpv</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">region_id</th>
<th data-quarto-table-cell-role="th">sample_id</th>
<th data-quarto-table-cell-role="th">FPS_scaled</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>chr1:905473-905483</td>
<td>2GAMBDQ_norm</td>
<td>0.065892</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>chr1:905473-905483</td>
<td>98JKPD8_lumA</td>
<td>0.045183</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>chr1:905473-905483</td>
<td>ANAB5F7_basal</td>
<td>0.062660</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>chr1:905473-905483</td>
<td>PU24GB8_lumB</td>
<td>0.056307</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>chr1:905473-905483</td>
<td>S6R691V_her2</td>
<td>0.069304</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10920</td>
<td>chrX:150849074-150849084</td>
<td>2GAMBDQ_norm</td>
<td>0.096162</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10921</td>
<td>chrX:150849074-150849084</td>
<td>98JKPD8_lumA</td>
<td>0.151456</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10922</td>
<td>chrX:150849074-150849084</td>
<td>ANAB5F7_basal</td>
<td>0.037761</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10923</td>
<td>chrX:150849074-150849084</td>
<td>PU24GB8_lumB</td>
<td>0.115831</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10924</td>
<td>chrX:150849074-150849084</td>
<td>S6R691V_her2</td>
<td>0.179197</td>
</tr>
</tbody>
</table>

<p>10925 rows × 3 columns</p>
</div>
</div>
</div>
<div id="cell-14" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot fps distribution</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>), dpi<span class="op">=</span><span class="dv">300</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>sns.kdeplot(data<span class="op">=</span>fps_df_scaled_lpv, x<span class="op">=</span><span class="st">"FPS_scaled"</span>, hue<span class="op">=</span><span class="st">"sample_id"</span>, fill<span class="op">=</span><span class="va">False</span>, common_norm<span class="op">=</span><span class="va">False</span>, alpha<span class="op">=</span><span class="fl">.5</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="variant-freq-analysis-v4_files/figure-html/cell-10-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="merging-afps_df_lpv-and-fps_df_scaled_lpv" class="level3">
<h3 class="anchored" data-anchor-id="merging-afps_df_lpv-and-fps_df_scaled_lpv">Merging <code>afps_df_lpv</code> and <code>fps_df_scaled_lpv</code></h3>
<p>Now we can merge the two long dataframes together to get both raw FPS and scaled FPS values in one dataframe.</p>
<div id="cell-16" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>afps_df_lpv</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">region_id</th>
<th data-quarto-table-cell-role="th">sample_id</th>
<th data-quarto-table-cell-role="th">AF</th>
<th data-quarto-table-cell-role="th">FPS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>chr1:905473-905483</td>
<td>2GAMBDQ_norm</td>
<td>0.000000</td>
<td>0.14062</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>chr1:905473-905483</td>
<td>98JKPD8_lumA</td>
<td>0.000000</td>
<td>0.10260</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>chr1:905473-905483</td>
<td>ANAB5F7_basal</td>
<td>0.000000</td>
<td>0.12218</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>chr1:905473-905483</td>
<td>PU24GB8_lumB</td>
<td>0.027778</td>
<td>0.12024</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>chr1:905473-905483</td>
<td>S6R691V_her2</td>
<td>0.000000</td>
<td>0.13921</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10920</td>
<td>chrX:150849074-150849084</td>
<td>2GAMBDQ_norm</td>
<td>0.750000</td>
<td>0.20522</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10921</td>
<td>chrX:150849074-150849084</td>
<td>98JKPD8_lumA</td>
<td>0.500000</td>
<td>0.34392</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10922</td>
<td>chrX:150849074-150849084</td>
<td>ANAB5F7_basal</td>
<td>0.600000</td>
<td>0.07363</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10923</td>
<td>chrX:150849074-150849084</td>
<td>PU24GB8_lumB</td>
<td>0.605263</td>
<td>0.24735</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10924</td>
<td>chrX:150849074-150849084</td>
<td>S6R691V_her2</td>
<td>0.588235</td>
<td>0.35995</td>
</tr>
</tbody>
</table>

<p>10925 rows × 4 columns</p>
</div>
</div>
</div>
<div id="cell-17" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>fps_df_scaled_lpv</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">region_id</th>
<th data-quarto-table-cell-role="th">sample_id</th>
<th data-quarto-table-cell-role="th">FPS_scaled</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>chr1:905473-905483</td>
<td>2GAMBDQ_norm</td>
<td>0.065892</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>chr1:905473-905483</td>
<td>98JKPD8_lumA</td>
<td>0.045183</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>chr1:905473-905483</td>
<td>ANAB5F7_basal</td>
<td>0.062660</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>chr1:905473-905483</td>
<td>PU24GB8_lumB</td>
<td>0.056307</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>chr1:905473-905483</td>
<td>S6R691V_her2</td>
<td>0.069304</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10920</td>
<td>chrX:150849074-150849084</td>
<td>2GAMBDQ_norm</td>
<td>0.096162</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10921</td>
<td>chrX:150849074-150849084</td>
<td>98JKPD8_lumA</td>
<td>0.151456</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10922</td>
<td>chrX:150849074-150849084</td>
<td>ANAB5F7_basal</td>
<td>0.037761</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10923</td>
<td>chrX:150849074-150849084</td>
<td>PU24GB8_lumB</td>
<td>0.115831</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10924</td>
<td>chrX:150849074-150849084</td>
<td>S6R691V_her2</td>
<td>0.179197</td>
</tr>
</tbody>
</table>

<p>10925 rows × 3 columns</p>
</div>
</div>
</div>
<div id="cell-18" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> sm.qqplot(fps_df_scaled_lpv[<span class="st">'FPS_scaled'</span>], line<span class="op">=</span><span class="st">'45'</span>, fit<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="variant-freq-analysis-v4_files/figure-html/cell-13-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-19" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># merge two dataframes on region_id and sample_id</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>afps_full_dfl <span class="op">=</span> afps_df_lpv.merge(fps_df_scaled_lpv, on<span class="op">=</span>[<span class="st">'region_id'</span>, <span class="st">'sample_id'</span>])</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>afps_full_dfl</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">region_id</th>
<th data-quarto-table-cell-role="th">sample_id</th>
<th data-quarto-table-cell-role="th">AF</th>
<th data-quarto-table-cell-role="th">FPS</th>
<th data-quarto-table-cell-role="th">FPS_scaled</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>chr1:905473-905483</td>
<td>2GAMBDQ_norm</td>
<td>0.000000</td>
<td>0.14062</td>
<td>0.065892</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>chr1:905473-905483</td>
<td>98JKPD8_lumA</td>
<td>0.000000</td>
<td>0.10260</td>
<td>0.045183</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>chr1:905473-905483</td>
<td>ANAB5F7_basal</td>
<td>0.000000</td>
<td>0.12218</td>
<td>0.062660</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>chr1:905473-905483</td>
<td>PU24GB8_lumB</td>
<td>0.027778</td>
<td>0.12024</td>
<td>0.056307</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>chr1:905473-905483</td>
<td>S6R691V_her2</td>
<td>0.000000</td>
<td>0.13921</td>
<td>0.069304</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10920</td>
<td>chrX:150849074-150849084</td>
<td>2GAMBDQ_norm</td>
<td>0.750000</td>
<td>0.20522</td>
<td>0.096162</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10921</td>
<td>chrX:150849074-150849084</td>
<td>98JKPD8_lumA</td>
<td>0.500000</td>
<td>0.34392</td>
<td>0.151456</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10922</td>
<td>chrX:150849074-150849084</td>
<td>ANAB5F7_basal</td>
<td>0.600000</td>
<td>0.07363</td>
<td>0.037761</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10923</td>
<td>chrX:150849074-150849084</td>
<td>PU24GB8_lumB</td>
<td>0.605263</td>
<td>0.24735</td>
<td>0.115831</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10924</td>
<td>chrX:150849074-150849084</td>
<td>S6R691V_her2</td>
<td>0.588235</td>
<td>0.35995</td>
<td>0.179197</td>
</tr>
</tbody>
</table>

<p>10925 rows × 5 columns</p>
</div>
</div>
</div>
<div id="cell-20" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> sm.qqplot(afps_full_dfl[<span class="st">'FPS_scaled'</span>], line<span class="op">=</span><span class="st">'45'</span>, fit<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'QQ plot of scaled FPS values'</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="variant-freq-analysis-v4_files/figure-html/cell-15-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-21" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> sm.qqplot(afps_full_dfl[<span class="st">'AF'</span>], line<span class="op">=</span><span class="st">'45'</span>, fit<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'QQ plot of AF values'</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="variant-freq-analysis-v4_files/figure-html/cell-16-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-23" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save to file</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># afps_full_dfl.to_csv(f'/home/msazizan/hyperspace/gatk-workflow/plotting/output-data/AF-FPS_regionsorted_full_longtable/{motif_id}_afps_full_scaled_longtable.tsv', sep='\t', index=False)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-24" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>sns.jointplot(data<span class="op">=</span>afps_full_dfl, x<span class="op">=</span><span class="st">'AF'</span>, y<span class="op">=</span><span class="st">'FPS_scaled'</span>, kind<span class="op">=</span><span class="st">'scatter'</span>, hue<span class="op">=</span><span class="st">'sample_id'</span>, height<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="variant-freq-analysis-v4_files/figure-html/cell-19-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="calculating-variation-statistics" class="level3">
<h3 class="anchored" data-anchor-id="calculating-variation-statistics">Calculating Variation Statistics</h3>
<p>With the full data table cleaned up into a long format, we can now calculate the variation statistics for each region. We will calculate the following statistics: * variance (Var) * <del>coefficient of variation (CV)</del> * <del>quartile coefficient of dispersion (QCD)</del></p>
<p>First calculate statistics on the raw FPS data.</p>
<div id="cell-27" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract fps columns</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>fps_df <span class="op">=</span> matrix_afps.<span class="bu">filter</span>(regex<span class="op">=</span><span class="st">'_fps$|_id$'</span>).copy()</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate variance of fps values across samples per region_id and add to a new column called 'fps_var'</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>fps_df <span class="op">=</span> fps_df.set_index(<span class="st">'region_id'</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>fps_df[<span class="st">'FPS_var'</span>] <span class="op">=</span> fps_df.var(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the coefficient of variation (CV) of fps values across samples per region_id and add to a new column called 'fps_cv'</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co"># fps_df['FPS_cv'] = fps_df.drop(columns=['FPS_var']).std(axis=1) / fps_df.drop(columns=['FPS_var']).mean(axis=1) * 100</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the quartile coefficient of dispersion (QCD) of fps values across samples per region_id and add to a new column called 'fps_qcd'</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co"># fps_df['FPS_qcd'] = (fps_df.drop(columns=['FPS_var', 'FPS_cv']).quantile(q=0.75, axis=1) - fps_df.drop(columns=['FPS_var', 'FPS_cv']).quantile(q=0.25, axis=1)) / (fps_df.drop(columns=['FPS_var', 'FPS_cv']).quantile(q=0.75, axis=1) + fps_df.drop(columns=['FPS_var', 'FPS_cv']).quantile(q=0.25, axis=1))</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>fps_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">98JKPD8_lumA_fps</th>
<th data-quarto-table-cell-role="th">ANAB5F7_basal_fps</th>
<th data-quarto-table-cell-role="th">S6R691V_her2_fps</th>
<th data-quarto-table-cell-role="th">PU24GB8_lumB_fps</th>
<th data-quarto-table-cell-role="th">2GAMBDQ_norm_fps</th>
<th data-quarto-table-cell-role="th">FPS_var</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">region_id</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">chr1:905473-905483</td>
<td>0.10260</td>
<td>0.12218</td>
<td>0.13921</td>
<td>0.12024</td>
<td>0.14062</td>
<td>0.000245</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">chr1:925405-925415</td>
<td>0.09540</td>
<td>0.03670</td>
<td>0.09011</td>
<td>0.05082</td>
<td>0.05586</td>
<td>0.000659</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">chr1:1020750-1020760</td>
<td>0.09749</td>
<td>0.09080</td>
<td>0.07864</td>
<td>0.10880</td>
<td>0.08458</td>
<td>0.000137</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">chr1:1130413-1130423</td>
<td>0.11471</td>
<td>0.04786</td>
<td>0.11338</td>
<td>0.14384</td>
<td>0.15151</td>
<td>0.001668</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">chr1:1225277-1225287</td>
<td>0.01792</td>
<td>0.04624</td>
<td>0.02729</td>
<td>0.01957</td>
<td>0.02657</td>
<td>0.000127</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Then do the same on the fps scaled data.</p>
<div id="cell-29" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># copy fps_df_scaled</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>fps_df_scaled_cp <span class="op">=</span> fps_df_scaled.copy()</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate variance of fps_scaled values across samples per region_id and add to a new column called 'fps_scaled_var'</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>fps_df_scaled_cp[<span class="st">'FPS_scaled_var'</span>] <span class="op">=</span> fps_df_scaled_cp.var(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the coefficient of variation (CV) of fps values across samples per region_id and add to a new column called 'fps_scaled_cv'</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co"># fps_df_scaled['FPS_scaled_cv'] = fps_df_scaled.drop(columns=['FPS_scaled_var']).std(axis=1) / fps_df_scaled.drop(columns=['FPS_scaled_var']).mean(axis=1) * 100</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the quartile coefficient of dispersion (QCD) of fps values across samples per region_id and add to a new column called 'fps_scaled_qcd'</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co"># fps_df_scaled['FPS_scaled_qcd'] = (fps_df_scaled.drop(columns=['FPS_scaled_var', 'FPS_scaled_cv']).quantile(q=0.75, axis=1) - fps_df_scaled.drop(columns=['FPS_scaled_var', 'FPS_scaled_cv']).quantile(q=0.25, axis=1)) / (fps_df_scaled.drop(columns=['FPS_scaled_var', 'FPS_scaled_cv']).quantile(q=0.75, axis=1) + fps_df_scaled.drop(columns=['FPS_scaled_var', 'FPS_scaled_cv']).quantile(q=0.25, axis=1))</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>fps_df_scaled_cp.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">98JKPD8_lumA_fps_scaled</th>
<th data-quarto-table-cell-role="th">ANAB5F7_basal_fps_scaled</th>
<th data-quarto-table-cell-role="th">S6R691V_her2_fps_scaled</th>
<th data-quarto-table-cell-role="th">PU24GB8_lumB_fps_scaled</th>
<th data-quarto-table-cell-role="th">2GAMBDQ_norm_fps_scaled</th>
<th data-quarto-table-cell-role="th">FPS_scaled_var</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">region_id</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">chr1:905473-905483</td>
<td>0.045183</td>
<td>0.062660</td>
<td>0.069304</td>
<td>0.056307</td>
<td>0.065892</td>
<td>0.000090</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">chr1:925405-925415</td>
<td>0.042012</td>
<td>0.018821</td>
<td>0.044860</td>
<td>0.023798</td>
<td>0.026175</td>
<td>0.000134</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">chr1:1020750-1020760</td>
<td>0.042933</td>
<td>0.046566</td>
<td>0.039150</td>
<td>0.050950</td>
<td>0.039632</td>
<td>0.000025</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">chr1:1130413-1130423</td>
<td>0.050516</td>
<td>0.024545</td>
<td>0.056445</td>
<td>0.067359</td>
<td>0.070994</td>
<td>0.000338</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">chr1:1225277-1225287</td>
<td>0.007892</td>
<td>0.023714</td>
<td>0.013586</td>
<td>0.009164</td>
<td>0.012450</td>
<td>0.000039</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-30" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Do the same for AF values</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># extract af columns</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>af_df <span class="op">=</span> matrix_afps.<span class="bu">filter</span>(regex<span class="op">=</span><span class="st">'_AF$|_id$'</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>af_df <span class="op">=</span> af_df.set_index(<span class="st">'region_id'</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># then calculate variance of af values across samples per region_id and add to a new column called 'af_var'</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>af_df[<span class="st">'AF_var'</span>] <span class="op">=</span> af_df.var(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>af_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">2GAMBDQ_norm_AF</th>
<th data-quarto-table-cell-role="th">98JKPD8_lumA_AF</th>
<th data-quarto-table-cell-role="th">ANAB5F7_basal_AF</th>
<th data-quarto-table-cell-role="th">PU24GB8_lumB_AF</th>
<th data-quarto-table-cell-role="th">S6R691V_her2_AF</th>
<th data-quarto-table-cell-role="th">AF_var</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">region_id</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">chr1:905473-905483</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.027778</td>
<td>0.000000</td>
<td>0.000154</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">chr1:925405-925415</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.730769</td>
<td>0.769231</td>
<td>0.730769</td>
<td>0.019970</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">chr1:1020750-1020760</td>
<td>0.062500</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000781</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">chr1:1130413-1130423</td>
<td>0.250000</td>
<td>0.181818</td>
<td>0.062500</td>
<td>0.131579</td>
<td>0.147059</td>
<td>0.004728</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">chr1:1225277-1225287</td>
<td>0.071429</td>
<td>0.090909</td>
<td>0.062500</td>
<td>0.078947</td>
<td>0.088235</td>
<td>0.000139</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Now merge the statistics tables together on <code>region_id</code> index.</p>
<div id="cell-32" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># subset only the fps stats columns</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co"># fps_stats_df = fps_df.filter(regex='_var$|_cv$|_qcd$|_id$').copy()</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co"># fps_scaled_stats_df = fps_df_scaled.filter(regex='_var$|_cv$|_qcd$|_id$').copy()</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>fps_stats_df <span class="op">=</span> fps_df.<span class="bu">filter</span>(regex<span class="op">=</span><span class="st">'_var$|_id$'</span>).copy()</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>fps_scaled_stats_df <span class="op">=</span> fps_df_scaled_cp.<span class="bu">filter</span>(regex<span class="op">=</span><span class="st">'_var$|_id$'</span>).copy()</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>af_stats_df <span class="op">=</span> af_df.<span class="bu">filter</span>(regex<span class="op">=</span><span class="st">'_var$|_id$'</span>).copy()</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># merge on region_id index from both tables</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>fps_stats_df_temp <span class="op">=</span> fps_stats_df.merge(fps_scaled_stats_df, left_index<span class="op">=</span><span class="va">True</span>, right_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co"># now merge with af_df</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>afps_stats_df <span class="op">=</span> fps_stats_df_temp.merge(af_stats_df, left_index<span class="op">=</span><span class="va">True</span>, right_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>afps_stats_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">FPS_var</th>
<th data-quarto-table-cell-role="th">FPS_scaled_var</th>
<th data-quarto-table-cell-role="th">AF_var</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">region_id</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">chr1:905473-905483</td>
<td>0.000245</td>
<td>9.036129e-05</td>
<td>0.000154</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">chr1:925405-925415</td>
<td>0.000659</td>
<td>1.341879e-04</td>
<td>0.019970</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">chr1:1020750-1020760</td>
<td>0.000137</td>
<td>2.462661e-05</td>
<td>0.000781</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">chr1:1130413-1130423</td>
<td>0.001668</td>
<td>3.382467e-04</td>
<td>0.004728</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">chr1:1225277-1225287</td>
<td>0.000127</td>
<td>3.889771e-05</td>
<td>0.000139</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">chrX:118300271-118300281</td>
<td>0.000003</td>
<td>1.009942e-06</td>
<td>0.001020</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">chrX:119211181-119211191</td>
<td>0.000003</td>
<td>5.101216e-07</td>
<td>0.001672</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">chrX:139342109-139342119</td>
<td>0.000031</td>
<td>6.536719e-06</td>
<td>0.000889</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">chrX:147508113-147508123</td>
<td>0.000012</td>
<td>2.588244e-06</td>
<td>0.000413</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">chrX:150849074-150849084</td>
<td>0.013487</td>
<td>2.941480e-03</td>
<td>0.008072</td>
</tr>
</tbody>
</table>

<p>2185 rows × 3 columns</p>
</div>
</div>
</div>
<p>Now we have a table of stats data to merge with the longform AF_FPS table (<code>afps_full_dfl</code>).</p>
<div id="cell-34" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set the index to 'region_id'</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>afps_full_dfli <span class="op">=</span> afps_full_dfl.set_index(<span class="st">'region_id'</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>afps_full_dfli</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">sample_id</th>
<th data-quarto-table-cell-role="th">AF</th>
<th data-quarto-table-cell-role="th">FPS</th>
<th data-quarto-table-cell-role="th">FPS_scaled</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">region_id</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">chr1:905473-905483</td>
<td>2GAMBDQ_norm</td>
<td>0.000000</td>
<td>0.14062</td>
<td>0.065892</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">chr1:905473-905483</td>
<td>98JKPD8_lumA</td>
<td>0.000000</td>
<td>0.10260</td>
<td>0.045183</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">chr1:905473-905483</td>
<td>ANAB5F7_basal</td>
<td>0.000000</td>
<td>0.12218</td>
<td>0.062660</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">chr1:905473-905483</td>
<td>PU24GB8_lumB</td>
<td>0.027778</td>
<td>0.12024</td>
<td>0.056307</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">chr1:905473-905483</td>
<td>S6R691V_her2</td>
<td>0.000000</td>
<td>0.13921</td>
<td>0.069304</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">chrX:150849074-150849084</td>
<td>2GAMBDQ_norm</td>
<td>0.750000</td>
<td>0.20522</td>
<td>0.096162</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">chrX:150849074-150849084</td>
<td>98JKPD8_lumA</td>
<td>0.500000</td>
<td>0.34392</td>
<td>0.151456</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">chrX:150849074-150849084</td>
<td>ANAB5F7_basal</td>
<td>0.600000</td>
<td>0.07363</td>
<td>0.037761</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">chrX:150849074-150849084</td>
<td>PU24GB8_lumB</td>
<td>0.605263</td>
<td>0.24735</td>
<td>0.115831</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">chrX:150849074-150849084</td>
<td>S6R691V_her2</td>
<td>0.588235</td>
<td>0.35995</td>
<td>0.179197</td>
</tr>
</tbody>
</table>

<p>10925 rows × 4 columns</p>
</div>
</div>
</div>
<div id="cell-35" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># merge afps_full_dfli with stats df on region_id</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>afps_merged_stats <span class="op">=</span> afps_full_dfli.merge(afps_stats_df, left_index<span class="op">=</span><span class="va">True</span>, right_index<span class="op">=</span><span class="va">True</span>, how<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># sort naturally by region_id</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>afps_stats_mergesorted <span class="op">=</span>afps_merged_stats.reset_index().reindex(index<span class="op">=</span>index_natsorted(afps_merged_stats.index))</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>afps_stats_mergesorted</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">region_id</th>
<th data-quarto-table-cell-role="th">sample_id</th>
<th data-quarto-table-cell-role="th">AF</th>
<th data-quarto-table-cell-role="th">FPS</th>
<th data-quarto-table-cell-role="th">FPS_scaled</th>
<th data-quarto-table-cell-role="th">FPS_var</th>
<th data-quarto-table-cell-role="th">FPS_scaled_var</th>
<th data-quarto-table-cell-role="th">AF_var</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">5145</td>
<td>chr1:905473-905483</td>
<td>2GAMBDQ_norm</td>
<td>0.000000</td>
<td>0.14062</td>
<td>0.065892</td>
<td>0.000245</td>
<td>0.000090</td>
<td>0.000154</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5146</td>
<td>chr1:905473-905483</td>
<td>98JKPD8_lumA</td>
<td>0.000000</td>
<td>0.10260</td>
<td>0.045183</td>
<td>0.000245</td>
<td>0.000090</td>
<td>0.000154</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5147</td>
<td>chr1:905473-905483</td>
<td>ANAB5F7_basal</td>
<td>0.000000</td>
<td>0.12218</td>
<td>0.062660</td>
<td>0.000245</td>
<td>0.000090</td>
<td>0.000154</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5148</td>
<td>chr1:905473-905483</td>
<td>PU24GB8_lumB</td>
<td>0.027778</td>
<td>0.12024</td>
<td>0.056307</td>
<td>0.000245</td>
<td>0.000090</td>
<td>0.000154</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5149</td>
<td>chr1:905473-905483</td>
<td>S6R691V_her2</td>
<td>0.000000</td>
<td>0.13921</td>
<td>0.069304</td>
<td>0.000245</td>
<td>0.000090</td>
<td>0.000154</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10780</td>
<td>chrX:150849074-150849084</td>
<td>2GAMBDQ_norm</td>
<td>0.750000</td>
<td>0.20522</td>
<td>0.096162</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10781</td>
<td>chrX:150849074-150849084</td>
<td>98JKPD8_lumA</td>
<td>0.500000</td>
<td>0.34392</td>
<td>0.151456</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10782</td>
<td>chrX:150849074-150849084</td>
<td>ANAB5F7_basal</td>
<td>0.600000</td>
<td>0.07363</td>
<td>0.037761</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10783</td>
<td>chrX:150849074-150849084</td>
<td>PU24GB8_lumB</td>
<td>0.605263</td>
<td>0.24735</td>
<td>0.115831</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10784</td>
<td>chrX:150849074-150849084</td>
<td>S6R691V_her2</td>
<td>0.588235</td>
<td>0.35995</td>
<td>0.179197</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
</tbody>
</table>

<p>10925 rows × 8 columns</p>
</div>
</div>
</div>
<div id="cell-36" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save file </span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># afps_stats_mergesorted.to_csv(f'/home/msazizan/hyperspace/gatk-workflow/plotting/output-data/AF-FPS_regionsorted_full_longtable/{motif_id}_afps_full_scaled_longtable_with_stats.tsv', sep='\t', index=False)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="aside-visualizing-fps_scaled_var-and-af_var" class="level4">
<h4 class="anchored" data-anchor-id="aside-visualizing-fps_scaled_var-and-af_var">ASIDE: Visualizing <code>FPS_scaled_var</code> and <code>AF_var</code></h4>
<p>We can now see if there is a correlation between the variance of the AF and FPS values, per <code>region_id</code>. As the statistics are calculated per <code>region_id</code>, we can plot the <code>FPS_scaled_var</code> and <code>AF_var</code> values against each other.</p>
<div id="cell-38" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># subset a copy of the dataframe with only the AF_var and FPS_scaled_var columns and region_id</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>afps_stats_ms_var <span class="op">=</span> afps_stats_mergesorted[[<span class="st">'region_id'</span>, <span class="st">'FPS_scaled_var'</span>, <span class="st">'AF_var'</span>]].copy().drop_duplicates().reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co"># set region_id as index and then plot lmplot</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>afps_stats_ms_var <span class="op">=</span> afps_stats_ms_var.set_index(<span class="st">'region_id'</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>afps_stats_ms_var</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">FPS_scaled_var</th>
<th data-quarto-table-cell-role="th">AF_var</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">region_id</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">chr1:905473-905483</td>
<td>9.036129e-05</td>
<td>0.000154</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">chr1:925405-925415</td>
<td>1.341879e-04</td>
<td>0.019970</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">chr1:1020750-1020760</td>
<td>2.462661e-05</td>
<td>0.000781</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">chr1:1130413-1130423</td>
<td>3.382467e-04</td>
<td>0.004728</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">chr1:1225277-1225287</td>
<td>3.889771e-05</td>
<td>0.000139</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">chrX:118300271-118300281</td>
<td>1.009942e-06</td>
<td>0.001020</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">chrX:119211181-119211191</td>
<td>5.101216e-07</td>
<td>0.001672</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">chrX:139342109-139342119</td>
<td>6.536719e-06</td>
<td>0.000889</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">chrX:147508113-147508123</td>
<td>2.588244e-06</td>
<td>0.000413</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">chrX:150849074-150849084</td>
<td>2.941480e-03</td>
<td>0.008072</td>
</tr>
</tbody>
</table>

<p>2185 rows × 2 columns</p>
</div>
</div>
</div>
<div id="cell-39" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show rows with FPS_scaled_var &gt; 0.001 and AF_var &gt; 0.001</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>test_df <span class="op">=</span> afps_stats_ms_var[(afps_stats_ms_var[<span class="st">'FPS_scaled_var'</span>] <span class="op">&gt;</span> <span class="fl">0.001</span>) <span class="op">&amp;</span> (afps_stats_ms_var[<span class="st">'AF_var'</span>] <span class="op">&gt;</span> <span class="fl">0.001</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-40" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the jointplot</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.jointplot(data<span class="op">=</span>afps_stats_ms_var, x<span class="op">=</span><span class="st">"FPS_scaled_var"</span>, y<span class="op">=</span><span class="st">"AF_var"</span>, height<span class="op">=</span><span class="dv">10</span>, ratio<span class="op">=</span><span class="dv">5</span>, color<span class="op">=</span><span class="st">'darkslateblue'</span> )</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>g.fig.suptitle(<span class="ss">f'AF vs FPS var for </span><span class="sc">{</span>motif_id<span class="sc">}</span><span class="ss"> (unfiltered: </span><span class="sc">{</span><span class="bu">len</span>(afps_stats_ms_var)<span class="sc">}</span><span class="ss"> regions)'</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="variant-freq-analysis-v4_files/figure-html/cell-29-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-41" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the jointplot</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.jointplot(data<span class="op">=</span>test_df, x<span class="op">=</span><span class="st">"FPS_scaled_var"</span>, y<span class="op">=</span><span class="st">"AF_var"</span>, height<span class="op">=</span><span class="dv">10</span>, ratio<span class="op">=</span><span class="dv">5</span>, color<span class="op">=</span><span class="st">'darkslateblue'</span> )</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>g.fig.suptitle(<span class="ss">f'AF vs FPS var for </span><span class="sc">{</span>motif_id<span class="sc">}</span><span class="ss"> (filtered: </span><span class="sc">{</span><span class="bu">len</span>(test_df)<span class="sc">}</span><span class="ss"> regions)'</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="variant-freq-analysis-v4_files/figure-html/cell-30-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-42" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>test_df.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>(55, 2)</code></pre>
</div>
</div>
</section>
</section>
<section id="filtering-variant-sites-fps" class="level3">
<h3 class="anchored" data-anchor-id="filtering-variant-sites-fps">Filtering Variant Sites (FPS)</h3>
<p>From here on, it makes sense to filter out variant sites that has <code>FPS</code> value <code>== 0</code>. This means that the raw FPS values across subtypes are zero, i.e.&nbsp;there is no evidence of footprinting at all at these sites despite a TFBS matching a motif being present (assigned by TOBIAS).</p>
<div id="cell-44" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>afps_stats_mergesorted</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">region_id</th>
<th data-quarto-table-cell-role="th">sample_id</th>
<th data-quarto-table-cell-role="th">AF</th>
<th data-quarto-table-cell-role="th">FPS</th>
<th data-quarto-table-cell-role="th">FPS_scaled</th>
<th data-quarto-table-cell-role="th">FPS_var</th>
<th data-quarto-table-cell-role="th">FPS_scaled_var</th>
<th data-quarto-table-cell-role="th">AF_var</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">5145</td>
<td>chr1:905473-905483</td>
<td>2GAMBDQ_norm</td>
<td>0.000000</td>
<td>0.14062</td>
<td>0.065892</td>
<td>0.000245</td>
<td>0.000090</td>
<td>0.000154</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5146</td>
<td>chr1:905473-905483</td>
<td>98JKPD8_lumA</td>
<td>0.000000</td>
<td>0.10260</td>
<td>0.045183</td>
<td>0.000245</td>
<td>0.000090</td>
<td>0.000154</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5147</td>
<td>chr1:905473-905483</td>
<td>ANAB5F7_basal</td>
<td>0.000000</td>
<td>0.12218</td>
<td>0.062660</td>
<td>0.000245</td>
<td>0.000090</td>
<td>0.000154</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5148</td>
<td>chr1:905473-905483</td>
<td>PU24GB8_lumB</td>
<td>0.027778</td>
<td>0.12024</td>
<td>0.056307</td>
<td>0.000245</td>
<td>0.000090</td>
<td>0.000154</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5149</td>
<td>chr1:905473-905483</td>
<td>S6R691V_her2</td>
<td>0.000000</td>
<td>0.13921</td>
<td>0.069304</td>
<td>0.000245</td>
<td>0.000090</td>
<td>0.000154</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10780</td>
<td>chrX:150849074-150849084</td>
<td>2GAMBDQ_norm</td>
<td>0.750000</td>
<td>0.20522</td>
<td>0.096162</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10781</td>
<td>chrX:150849074-150849084</td>
<td>98JKPD8_lumA</td>
<td>0.500000</td>
<td>0.34392</td>
<td>0.151456</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10782</td>
<td>chrX:150849074-150849084</td>
<td>ANAB5F7_basal</td>
<td>0.600000</td>
<td>0.07363</td>
<td>0.037761</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10783</td>
<td>chrX:150849074-150849084</td>
<td>PU24GB8_lumB</td>
<td>0.605263</td>
<td>0.24735</td>
<td>0.115831</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10784</td>
<td>chrX:150849074-150849084</td>
<td>S6R691V_her2</td>
<td>0.588235</td>
<td>0.35995</td>
<td>0.179197</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
</tbody>
</table>

<p>10925 rows × 8 columns</p>
</div>
</div>
</div>
<div id="cell-45" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># filter out unique region_id rows that have fps == 0 across the sample_ids</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co"># group by 'region_id' first </span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>merged_filt <span class="op">=</span> afps_stats_mergesorted.groupby(<span class="st">'region_id'</span>).<span class="bu">filter</span>(<span class="kw">lambda</span> x: x[<span class="st">'FPS'</span>].<span class="bu">sum</span>() <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>merged_filt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">region_id</th>
<th data-quarto-table-cell-role="th">sample_id</th>
<th data-quarto-table-cell-role="th">AF</th>
<th data-quarto-table-cell-role="th">FPS</th>
<th data-quarto-table-cell-role="th">FPS_scaled</th>
<th data-quarto-table-cell-role="th">FPS_var</th>
<th data-quarto-table-cell-role="th">FPS_scaled_var</th>
<th data-quarto-table-cell-role="th">AF_var</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">5145</td>
<td>chr1:905473-905483</td>
<td>2GAMBDQ_norm</td>
<td>0.000000</td>
<td>0.14062</td>
<td>0.065892</td>
<td>0.000245</td>
<td>0.000090</td>
<td>0.000154</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5146</td>
<td>chr1:905473-905483</td>
<td>98JKPD8_lumA</td>
<td>0.000000</td>
<td>0.10260</td>
<td>0.045183</td>
<td>0.000245</td>
<td>0.000090</td>
<td>0.000154</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5147</td>
<td>chr1:905473-905483</td>
<td>ANAB5F7_basal</td>
<td>0.000000</td>
<td>0.12218</td>
<td>0.062660</td>
<td>0.000245</td>
<td>0.000090</td>
<td>0.000154</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5148</td>
<td>chr1:905473-905483</td>
<td>PU24GB8_lumB</td>
<td>0.027778</td>
<td>0.12024</td>
<td>0.056307</td>
<td>0.000245</td>
<td>0.000090</td>
<td>0.000154</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5149</td>
<td>chr1:905473-905483</td>
<td>S6R691V_her2</td>
<td>0.000000</td>
<td>0.13921</td>
<td>0.069304</td>
<td>0.000245</td>
<td>0.000090</td>
<td>0.000154</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10780</td>
<td>chrX:150849074-150849084</td>
<td>2GAMBDQ_norm</td>
<td>0.750000</td>
<td>0.20522</td>
<td>0.096162</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10781</td>
<td>chrX:150849074-150849084</td>
<td>98JKPD8_lumA</td>
<td>0.500000</td>
<td>0.34392</td>
<td>0.151456</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10782</td>
<td>chrX:150849074-150849084</td>
<td>ANAB5F7_basal</td>
<td>0.600000</td>
<td>0.07363</td>
<td>0.037761</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10783</td>
<td>chrX:150849074-150849084</td>
<td>PU24GB8_lumB</td>
<td>0.605263</td>
<td>0.24735</td>
<td>0.115831</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10784</td>
<td>chrX:150849074-150849084</td>
<td>S6R691V_her2</td>
<td>0.588235</td>
<td>0.35995</td>
<td>0.179197</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
</tbody>
</table>

<p>10755 rows × 8 columns</p>
</div>
</div>
</div>
<div id="cell-46" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># merged_filt[(merged_filt['FPS_cv'].isna() | merged_filt['FPS_qcd'].isna())]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We are not interested in footprints that carry no called variants so we can also filter out all rows with <code>AF == 0</code>, as these represent sites that are not variant at all. The only reason they are in the matrix is because during the raw data merging, these sites are retained when there is at least one subtype that has a non-zero AF value at that site, or non-zero FPS values at that site.</p>
<p>However, we would still be interested in sites with AF values not equal zero at least in one of the subtypes, so we do not want to filter out sites that have at least one non-zero AF value.</p>
<div id="cell-48" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># filter out unique region_id rows that have AF == 0 in all subtypes (sample_id grouping)</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co"># this has to be per group, so we need to groupby first</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>merged_filt_nozero <span class="op">=</span> merged_filt.groupby(<span class="st">'region_id'</span>).<span class="bu">filter</span>(<span class="kw">lambda</span> x: (x[<span class="st">'AF'</span>] <span class="op">!=</span> <span class="dv">0</span>).<span class="bu">any</span>())</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>merged_filt_nozero</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">region_id</th>
<th data-quarto-table-cell-role="th">sample_id</th>
<th data-quarto-table-cell-role="th">AF</th>
<th data-quarto-table-cell-role="th">FPS</th>
<th data-quarto-table-cell-role="th">FPS_scaled</th>
<th data-quarto-table-cell-role="th">FPS_var</th>
<th data-quarto-table-cell-role="th">FPS_scaled_var</th>
<th data-quarto-table-cell-role="th">AF_var</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">5145</td>
<td>chr1:905473-905483</td>
<td>2GAMBDQ_norm</td>
<td>0.000000</td>
<td>0.14062</td>
<td>0.065892</td>
<td>0.000245</td>
<td>0.000090</td>
<td>0.000154</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5146</td>
<td>chr1:905473-905483</td>
<td>98JKPD8_lumA</td>
<td>0.000000</td>
<td>0.10260</td>
<td>0.045183</td>
<td>0.000245</td>
<td>0.000090</td>
<td>0.000154</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5147</td>
<td>chr1:905473-905483</td>
<td>ANAB5F7_basal</td>
<td>0.000000</td>
<td>0.12218</td>
<td>0.062660</td>
<td>0.000245</td>
<td>0.000090</td>
<td>0.000154</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5148</td>
<td>chr1:905473-905483</td>
<td>PU24GB8_lumB</td>
<td>0.027778</td>
<td>0.12024</td>
<td>0.056307</td>
<td>0.000245</td>
<td>0.000090</td>
<td>0.000154</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5149</td>
<td>chr1:905473-905483</td>
<td>S6R691V_her2</td>
<td>0.000000</td>
<td>0.13921</td>
<td>0.069304</td>
<td>0.000245</td>
<td>0.000090</td>
<td>0.000154</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10780</td>
<td>chrX:150849074-150849084</td>
<td>2GAMBDQ_norm</td>
<td>0.750000</td>
<td>0.20522</td>
<td>0.096162</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10781</td>
<td>chrX:150849074-150849084</td>
<td>98JKPD8_lumA</td>
<td>0.500000</td>
<td>0.34392</td>
<td>0.151456</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10782</td>
<td>chrX:150849074-150849084</td>
<td>ANAB5F7_basal</td>
<td>0.600000</td>
<td>0.07363</td>
<td>0.037761</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10783</td>
<td>chrX:150849074-150849084</td>
<td>PU24GB8_lumB</td>
<td>0.605263</td>
<td>0.24735</td>
<td>0.115831</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10784</td>
<td>chrX:150849074-150849084</td>
<td>S6R691V_her2</td>
<td>0.588235</td>
<td>0.35995</td>
<td>0.179197</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
</tbody>
</table>

<p>10185 rows × 8 columns</p>
</div>
</div>
</div>
<p>Now we can select unique <code>region_id</code>s that have at least one AF value in the subtype group that is equal to 0 AND the max AF value in the subtype group is more than 0.5. This is because for sites that have a called variant in at least one subtype, we are only interested in them if the called variant has AF of more than 0.5.</p>
<p>We first group the df by the unique values of column <code>region_id</code>, then we retain only regions whose max value of column <code>AF</code> per unique site is more than 0.5.</p>
<div id="cell-50" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for each unique region_id, find those that has AF == 0 in at least one subtype</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="co"># this has to be per group, so we need to groupby first</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>region_af_zero <span class="op">=</span> merged_filt_nozero.groupby(<span class="st">'region_id'</span>).<span class="bu">filter</span>(<span class="kw">lambda</span> x: (x[<span class="st">'AF'</span>] <span class="op">==</span> <span class="dv">0</span>).<span class="bu">any</span>())</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>region_af_zero</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">region_id</th>
<th data-quarto-table-cell-role="th">sample_id</th>
<th data-quarto-table-cell-role="th">AF</th>
<th data-quarto-table-cell-role="th">FPS</th>
<th data-quarto-table-cell-role="th">FPS_scaled</th>
<th data-quarto-table-cell-role="th">FPS_var</th>
<th data-quarto-table-cell-role="th">FPS_scaled_var</th>
<th data-quarto-table-cell-role="th">AF_var</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">5145</td>
<td>chr1:905473-905483</td>
<td>2GAMBDQ_norm</td>
<td>0.000000</td>
<td>0.14062</td>
<td>0.065892</td>
<td>0.000245</td>
<td>0.000090</td>
<td>0.000154</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5146</td>
<td>chr1:905473-905483</td>
<td>98JKPD8_lumA</td>
<td>0.000000</td>
<td>0.10260</td>
<td>0.045183</td>
<td>0.000245</td>
<td>0.000090</td>
<td>0.000154</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5147</td>
<td>chr1:905473-905483</td>
<td>ANAB5F7_basal</td>
<td>0.000000</td>
<td>0.12218</td>
<td>0.062660</td>
<td>0.000245</td>
<td>0.000090</td>
<td>0.000154</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5148</td>
<td>chr1:905473-905483</td>
<td>PU24GB8_lumB</td>
<td>0.027778</td>
<td>0.12024</td>
<td>0.056307</td>
<td>0.000245</td>
<td>0.000090</td>
<td>0.000154</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5149</td>
<td>chr1:905473-905483</td>
<td>S6R691V_her2</td>
<td>0.000000</td>
<td>0.13921</td>
<td>0.069304</td>
<td>0.000245</td>
<td>0.000090</td>
<td>0.000154</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10775</td>
<td>chrX:147508113-147508123</td>
<td>2GAMBDQ_norm</td>
<td>0.000000</td>
<td>0.01465</td>
<td>0.006865</td>
<td>0.000012</td>
<td>0.000003</td>
<td>0.000413</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10776</td>
<td>chrX:147508113-147508123</td>
<td>98JKPD8_lumA</td>
<td>0.000000</td>
<td>0.00810</td>
<td>0.003567</td>
<td>0.000012</td>
<td>0.000003</td>
<td>0.000413</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10777</td>
<td>chrX:147508113-147508123</td>
<td>ANAB5F7_basal</td>
<td>0.045455</td>
<td>0.00633</td>
<td>0.003246</td>
<td>0.000012</td>
<td>0.000003</td>
<td>0.000413</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10778</td>
<td>chrX:147508113-147508123</td>
<td>PU24GB8_lumB</td>
<td>0.000000</td>
<td>0.00629</td>
<td>0.002946</td>
<td>0.000012</td>
<td>0.000003</td>
<td>0.000413</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10779</td>
<td>chrX:147508113-147508123</td>
<td>S6R691V_her2</td>
<td>0.000000</td>
<td>0.00697</td>
<td>0.003470</td>
<td>0.000012</td>
<td>0.000003</td>
<td>0.000413</td>
</tr>
</tbody>
</table>

<p>6950 rows × 8 columns</p>
</div>
</div>
</div>
<div id="cell-51" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># then find the max AF value for each region_id and add to a new column called 'max_AF'</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> region_af_zero.groupby(<span class="st">'region_id'</span>).agg({<span class="st">'AF'</span>: <span class="st">'max'</span>}).rename(columns<span class="op">=</span>{<span class="st">'AF'</span>: <span class="st">'max_AF'</span>}).reset_index()</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>max_af <span class="op">=</span> df.reindex(index<span class="op">=</span>index_natsorted(df[<span class="st">'region_id'</span>]))</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>max_af</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">region_id</th>
<th data-quarto-table-cell-role="th">max_AF</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">640</td>
<td>chr1:905473-905483</td>
<td>0.027778</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">526</td>
<td>chr1:1020750-1020760</td>
<td>0.062500</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">617</td>
<td>chr1:3432506-3432516</td>
<td>0.166667</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">625</td>
<td>chr1:3948502-3948512</td>
<td>0.181818</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">629</td>
<td>chr1:5274704-5274714</td>
<td>0.250000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1365</td>
<td>chrX:115338019-115338029</td>
<td>0.029412</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1366</td>
<td>chrX:118300271-118300281</td>
<td>0.071429</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1367</td>
<td>chrX:119211181-119211191</td>
<td>0.093750</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1368</td>
<td>chrX:139342109-139342119</td>
<td>0.066667</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1369</td>
<td>chrX:147508113-147508123</td>
<td>0.045455</td>
</tr>
</tbody>
</table>

<p>1390 rows × 2 columns</p>
</div>
</div>
</div>
<div id="cell-52" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># now return a boolean mask for regions that have max_AF &lt;= 0.5</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> max_af[<span class="st">'max_AF'</span>] <span class="op">&lt;=</span> <span class="fl">0.5</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co"># sum here counts the number of True values in the mask</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>mask.<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>1379</code></pre>
</div>
</div>
<p>Now we can filter the merged dataframes such that rows that have <code>region_id</code> in the Boolean-masked <code>max_af</code> &lt;= 0.5 dataframe will be discarded (so we retain only <code>region_id</code> rows that have <code>max_af</code> &gt; 0.5).</p>
<div id="cell-54" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this is done by subsetting the long dataframe with an expression that makes use of isin() method on the max_af dataframe masked by the boolean series, and then taking the inverse of the expression using ~</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>merged_filt_nolowaf <span class="op">=</span> merged_filt_nozero[<span class="op">~</span>(merged_filt_nozero[<span class="st">'region_id'</span>].isin(max_af[mask][<span class="st">'region_id'</span>]))]</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>merged_filt_nolowaf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">region_id</th>
<th data-quarto-table-cell-role="th">sample_id</th>
<th data-quarto-table-cell-role="th">AF</th>
<th data-quarto-table-cell-role="th">FPS</th>
<th data-quarto-table-cell-role="th">FPS_scaled</th>
<th data-quarto-table-cell-role="th">FPS_var</th>
<th data-quarto-table-cell-role="th">FPS_scaled_var</th>
<th data-quarto-table-cell-role="th">AF_var</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">5160</td>
<td>chr1:925405-925415</td>
<td>2GAMBDQ_norm</td>
<td>1.000000</td>
<td>0.05586</td>
<td>0.026175</td>
<td>0.000659</td>
<td>0.000134</td>
<td>0.019970</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5161</td>
<td>chr1:925405-925415</td>
<td>98JKPD8_lumA</td>
<td>1.000000</td>
<td>0.09540</td>
<td>0.042012</td>
<td>0.000659</td>
<td>0.000134</td>
<td>0.019970</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5162</td>
<td>chr1:925405-925415</td>
<td>ANAB5F7_basal</td>
<td>0.730769</td>
<td>0.03670</td>
<td>0.018821</td>
<td>0.000659</td>
<td>0.000134</td>
<td>0.019970</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5163</td>
<td>chr1:925405-925415</td>
<td>PU24GB8_lumB</td>
<td>0.769231</td>
<td>0.05082</td>
<td>0.023798</td>
<td>0.000659</td>
<td>0.000134</td>
<td>0.019970</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5164</td>
<td>chr1:925405-925415</td>
<td>S6R691V_her2</td>
<td>0.730769</td>
<td>0.09011</td>
<td>0.044860</td>
<td>0.000659</td>
<td>0.000134</td>
<td>0.019970</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10780</td>
<td>chrX:150849074-150849084</td>
<td>2GAMBDQ_norm</td>
<td>0.750000</td>
<td>0.20522</td>
<td>0.096162</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10781</td>
<td>chrX:150849074-150849084</td>
<td>98JKPD8_lumA</td>
<td>0.500000</td>
<td>0.34392</td>
<td>0.151456</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10782</td>
<td>chrX:150849074-150849084</td>
<td>ANAB5F7_basal</td>
<td>0.600000</td>
<td>0.07363</td>
<td>0.037761</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10783</td>
<td>chrX:150849074-150849084</td>
<td>PU24GB8_lumB</td>
<td>0.605263</td>
<td>0.24735</td>
<td>0.115831</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10784</td>
<td>chrX:150849074-150849084</td>
<td>S6R691V_her2</td>
<td>0.588235</td>
<td>0.35995</td>
<td>0.179197</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
</tbody>
</table>

<p>3290 rows × 8 columns</p>
</div>
</div>
</div>
<div id="cell-55" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># now filter out the rows with AF == 0 on the merge_filt dataframe</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>merged_filt_nozeroaf <span class="op">=</span> merged_filt_nozero[<span class="op">~</span>(merged_filt_nozero[<span class="st">'region_id'</span>].isin(max_af[<span class="st">'region_id'</span>]))]</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>merged_filt_nozeroaf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">region_id</th>
<th data-quarto-table-cell-role="th">sample_id</th>
<th data-quarto-table-cell-role="th">AF</th>
<th data-quarto-table-cell-role="th">FPS</th>
<th data-quarto-table-cell-role="th">FPS_scaled</th>
<th data-quarto-table-cell-role="th">FPS_var</th>
<th data-quarto-table-cell-role="th">FPS_scaled_var</th>
<th data-quarto-table-cell-role="th">AF_var</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">5160</td>
<td>chr1:925405-925415</td>
<td>2GAMBDQ_norm</td>
<td>1.000000</td>
<td>0.05586</td>
<td>0.026175</td>
<td>0.000659</td>
<td>0.000134</td>
<td>0.019970</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5161</td>
<td>chr1:925405-925415</td>
<td>98JKPD8_lumA</td>
<td>1.000000</td>
<td>0.09540</td>
<td>0.042012</td>
<td>0.000659</td>
<td>0.000134</td>
<td>0.019970</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5162</td>
<td>chr1:925405-925415</td>
<td>ANAB5F7_basal</td>
<td>0.730769</td>
<td>0.03670</td>
<td>0.018821</td>
<td>0.000659</td>
<td>0.000134</td>
<td>0.019970</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5163</td>
<td>chr1:925405-925415</td>
<td>PU24GB8_lumB</td>
<td>0.769231</td>
<td>0.05082</td>
<td>0.023798</td>
<td>0.000659</td>
<td>0.000134</td>
<td>0.019970</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5164</td>
<td>chr1:925405-925415</td>
<td>S6R691V_her2</td>
<td>0.730769</td>
<td>0.09011</td>
<td>0.044860</td>
<td>0.000659</td>
<td>0.000134</td>
<td>0.019970</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10780</td>
<td>chrX:150849074-150849084</td>
<td>2GAMBDQ_norm</td>
<td>0.750000</td>
<td>0.20522</td>
<td>0.096162</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10781</td>
<td>chrX:150849074-150849084</td>
<td>98JKPD8_lumA</td>
<td>0.500000</td>
<td>0.34392</td>
<td>0.151456</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10782</td>
<td>chrX:150849074-150849084</td>
<td>ANAB5F7_basal</td>
<td>0.600000</td>
<td>0.07363</td>
<td>0.037761</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10783</td>
<td>chrX:150849074-150849084</td>
<td>PU24GB8_lumB</td>
<td>0.605263</td>
<td>0.24735</td>
<td>0.115831</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10784</td>
<td>chrX:150849074-150849084</td>
<td>S6R691V_her2</td>
<td>0.588235</td>
<td>0.35995</td>
<td>0.179197</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
</tbody>
</table>

<p>3235 rows × 8 columns</p>
</div>
</div>
</div>
<div id="cell-56" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save the unique region_id rows where AF == 0 in at least one subtype to file just in case</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>atleast_one_zero_af <span class="op">=</span> merged_filt_nozero[merged_filt_nozero[<span class="st">'region_id'</span>].isin(max_af[<span class="st">'region_id'</span>])]</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>atleast_one_zero_af</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">region_id</th>
<th data-quarto-table-cell-role="th">sample_id</th>
<th data-quarto-table-cell-role="th">AF</th>
<th data-quarto-table-cell-role="th">FPS</th>
<th data-quarto-table-cell-role="th">FPS_scaled</th>
<th data-quarto-table-cell-role="th">FPS_var</th>
<th data-quarto-table-cell-role="th">FPS_scaled_var</th>
<th data-quarto-table-cell-role="th">AF_var</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">5145</td>
<td>chr1:905473-905483</td>
<td>2GAMBDQ_norm</td>
<td>0.000000</td>
<td>0.14062</td>
<td>0.065892</td>
<td>0.000245</td>
<td>0.000090</td>
<td>0.000154</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5146</td>
<td>chr1:905473-905483</td>
<td>98JKPD8_lumA</td>
<td>0.000000</td>
<td>0.10260</td>
<td>0.045183</td>
<td>0.000245</td>
<td>0.000090</td>
<td>0.000154</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5147</td>
<td>chr1:905473-905483</td>
<td>ANAB5F7_basal</td>
<td>0.000000</td>
<td>0.12218</td>
<td>0.062660</td>
<td>0.000245</td>
<td>0.000090</td>
<td>0.000154</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5148</td>
<td>chr1:905473-905483</td>
<td>PU24GB8_lumB</td>
<td>0.027778</td>
<td>0.12024</td>
<td>0.056307</td>
<td>0.000245</td>
<td>0.000090</td>
<td>0.000154</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5149</td>
<td>chr1:905473-905483</td>
<td>S6R691V_her2</td>
<td>0.000000</td>
<td>0.13921</td>
<td>0.069304</td>
<td>0.000245</td>
<td>0.000090</td>
<td>0.000154</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10775</td>
<td>chrX:147508113-147508123</td>
<td>2GAMBDQ_norm</td>
<td>0.000000</td>
<td>0.01465</td>
<td>0.006865</td>
<td>0.000012</td>
<td>0.000003</td>
<td>0.000413</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10776</td>
<td>chrX:147508113-147508123</td>
<td>98JKPD8_lumA</td>
<td>0.000000</td>
<td>0.00810</td>
<td>0.003567</td>
<td>0.000012</td>
<td>0.000003</td>
<td>0.000413</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10777</td>
<td>chrX:147508113-147508123</td>
<td>ANAB5F7_basal</td>
<td>0.045455</td>
<td>0.00633</td>
<td>0.003246</td>
<td>0.000012</td>
<td>0.000003</td>
<td>0.000413</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10778</td>
<td>chrX:147508113-147508123</td>
<td>PU24GB8_lumB</td>
<td>0.000000</td>
<td>0.00629</td>
<td>0.002946</td>
<td>0.000012</td>
<td>0.000003</td>
<td>0.000413</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10779</td>
<td>chrX:147508113-147508123</td>
<td>S6R691V_her2</td>
<td>0.000000</td>
<td>0.00697</td>
<td>0.003470</td>
<td>0.000012</td>
<td>0.000003</td>
<td>0.000413</td>
</tr>
</tbody>
</table>

<p>6950 rows × 8 columns</p>
</div>
</div>
</div>
</section>
<section id="filtering-variant-sites-af" class="level3">
<h3 class="anchored" data-anchor-id="filtering-variant-sites-af">Filtering Variant Sites (AF)</h3>
<p>Now we can calculate the median for AF values to append to the merged, filtered longform dataframe.</p>
<div id="cell-58" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># copy the filtered dataframe</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>mf_df <span class="op">=</span> merged_filt_nozeroaf.copy()</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>mf_df <span class="op">=</span> mf_df.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># # calculate AF mean per region_id</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="co"># mf_df['AF_mean'] = mf_df.groupby('region_id')['AF'].transform('mean')</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>mf_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">region_id</th>
<th data-quarto-table-cell-role="th">sample_id</th>
<th data-quarto-table-cell-role="th">AF</th>
<th data-quarto-table-cell-role="th">FPS</th>
<th data-quarto-table-cell-role="th">FPS_scaled</th>
<th data-quarto-table-cell-role="th">FPS_var</th>
<th data-quarto-table-cell-role="th">FPS_scaled_var</th>
<th data-quarto-table-cell-role="th">AF_var</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>chr1:925405-925415</td>
<td>2GAMBDQ_norm</td>
<td>1.000000</td>
<td>0.05586</td>
<td>0.026175</td>
<td>0.000659</td>
<td>0.000134</td>
<td>0.019970</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>chr1:925405-925415</td>
<td>98JKPD8_lumA</td>
<td>1.000000</td>
<td>0.09540</td>
<td>0.042012</td>
<td>0.000659</td>
<td>0.000134</td>
<td>0.019970</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>chr1:925405-925415</td>
<td>ANAB5F7_basal</td>
<td>0.730769</td>
<td>0.03670</td>
<td>0.018821</td>
<td>0.000659</td>
<td>0.000134</td>
<td>0.019970</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>chr1:925405-925415</td>
<td>PU24GB8_lumB</td>
<td>0.769231</td>
<td>0.05082</td>
<td>0.023798</td>
<td>0.000659</td>
<td>0.000134</td>
<td>0.019970</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>chr1:925405-925415</td>
<td>S6R691V_her2</td>
<td>0.730769</td>
<td>0.09011</td>
<td>0.044860</td>
<td>0.000659</td>
<td>0.000134</td>
<td>0.019970</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3230</td>
<td>chrX:150849074-150849084</td>
<td>2GAMBDQ_norm</td>
<td>0.750000</td>
<td>0.20522</td>
<td>0.096162</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3231</td>
<td>chrX:150849074-150849084</td>
<td>98JKPD8_lumA</td>
<td>0.500000</td>
<td>0.34392</td>
<td>0.151456</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3232</td>
<td>chrX:150849074-150849084</td>
<td>ANAB5F7_basal</td>
<td>0.600000</td>
<td>0.07363</td>
<td>0.037761</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3233</td>
<td>chrX:150849074-150849084</td>
<td>PU24GB8_lumB</td>
<td>0.605263</td>
<td>0.24735</td>
<td>0.115831</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3234</td>
<td>chrX:150849074-150849084</td>
<td>S6R691V_her2</td>
<td>0.588235</td>
<td>0.35995</td>
<td>0.179197</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
</tbody>
</table>

<p>3235 rows × 8 columns</p>
</div>
</div>
</div>
<p>Let’s visualize the AF distribution for each variant site.</p>
<div id="cell-60" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>dutchfield <span class="op">=</span> [<span class="st">"#e60049"</span>, <span class="st">"#0bb4ff"</span>, <span class="st">"#87bc45"</span>, <span class="st">"#ef9b20"</span>, <span class="st">"#b33dc6"</span>]</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>springpastel <span class="op">=</span> [<span class="st">"#fd7f6f"</span>, <span class="st">"#7eb0d5"</span>, <span class="st">"#b2e061"</span>, <span class="st">"#bd7ebe"</span>, <span class="st">"#ffb55a"</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-61" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot violin plot for AF on the filtered dataframe</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.figure(figsize=(10, 10), dpi=300)</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co"># sns.violinplot(x='region_id', y='AF', data=mf_df, color='lightgray', inner='quartile', linecolor='black', linewidth=0.5)</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.xticks(rotation=90, fontsize=2)</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co"># sns.stripplot(x='region_id', y='AF', data=mf_df, hue='sample_id', size=2.5, jitter=True, palette='deep')</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="co"># # plot legend outside of the plot</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.legend(bbox_to_anchor=(1.01, 1),borderaxespad=0, markerscale=2, fontsize=10)</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.xlabel(f'{motif_id} TF binding sites with allelic variants', fontsize=8)</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.ylabel('Allele frequency (AF)', fontsize=8)</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.show()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><del>Plotting the whole data makes the plot look very busy. We can split the data into 2 groups: ‘high AF’ and ‘low AF’. We will define ‘high AF’ as <code>AF_median</code> &gt; 0.5, and ‘low AF’ as <code>AF_median</code> &lt;= 0.5.</del></p>
<p>Let’s not just filter by <code>AF_median</code>, but instead filter for <code>region_id</code> in which none of the AF values are &lt; 0.5.</p>
<div id="cell-63" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># to ensure that each unique region_id is retained as a group of subtype rows, we need to filter after grouping per region_id</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co"># high_af = mf_df.groupby('region_id').filter(lambda x: (x['AF_median'] &gt; 0.5).any())</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>high_af <span class="op">=</span> mf_df.groupby(<span class="st">'region_id'</span>).<span class="bu">filter</span>(<span class="kw">lambda</span> x: (x[<span class="st">'AF'</span>] <span class="op">&gt;</span> <span class="fl">0.5</span>).<span class="bu">all</span>())</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>high_af</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">region_id</th>
<th data-quarto-table-cell-role="th">sample_id</th>
<th data-quarto-table-cell-role="th">AF</th>
<th data-quarto-table-cell-role="th">FPS</th>
<th data-quarto-table-cell-role="th">FPS_scaled</th>
<th data-quarto-table-cell-role="th">FPS_var</th>
<th data-quarto-table-cell-role="th">FPS_scaled_var</th>
<th data-quarto-table-cell-role="th">AF_var</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>chr1:925405-925415</td>
<td>2GAMBDQ_norm</td>
<td>1.000000</td>
<td>0.05586</td>
<td>0.026175</td>
<td>0.000659</td>
<td>0.000134</td>
<td>0.019970</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>chr1:925405-925415</td>
<td>98JKPD8_lumA</td>
<td>1.000000</td>
<td>0.09540</td>
<td>0.042012</td>
<td>0.000659</td>
<td>0.000134</td>
<td>0.019970</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>chr1:925405-925415</td>
<td>ANAB5F7_basal</td>
<td>0.730769</td>
<td>0.03670</td>
<td>0.018821</td>
<td>0.000659</td>
<td>0.000134</td>
<td>0.019970</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>chr1:925405-925415</td>
<td>PU24GB8_lumB</td>
<td>0.769231</td>
<td>0.05082</td>
<td>0.023798</td>
<td>0.000659</td>
<td>0.000134</td>
<td>0.019970</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>chr1:925405-925415</td>
<td>S6R691V_her2</td>
<td>0.730769</td>
<td>0.09011</td>
<td>0.044860</td>
<td>0.000659</td>
<td>0.000134</td>
<td>0.019970</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3200</td>
<td>chrX:34275969-34275979</td>
<td>2GAMBDQ_norm</td>
<td>0.857143</td>
<td>0.02658</td>
<td>0.012455</td>
<td>0.000088</td>
<td>0.000019</td>
<td>0.021762</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3201</td>
<td>chrX:34275969-34275979</td>
<td>98JKPD8_lumA</td>
<td>0.611111</td>
<td>0.03378</td>
<td>0.014876</td>
<td>0.000088</td>
<td>0.000019</td>
<td>0.021762</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3202</td>
<td>chrX:34275969-34275979</td>
<td>ANAB5F7_basal</td>
<td>0.888889</td>
<td>0.01175</td>
<td>0.006026</td>
<td>0.000088</td>
<td>0.000019</td>
<td>0.021762</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3203</td>
<td>chrX:34275969-34275979</td>
<td>PU24GB8_lumB</td>
<td>1.000000</td>
<td>0.02894</td>
<td>0.013552</td>
<td>0.000088</td>
<td>0.000019</td>
<td>0.021762</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3204</td>
<td>chrX:34275969-34275979</td>
<td>S6R691V_her2</td>
<td>0.750000</td>
<td>0.03548</td>
<td>0.017663</td>
<td>0.000088</td>
<td>0.000019</td>
<td>0.021762</td>
</tr>
</tbody>
</table>

<p>635 rows × 8 columns</p>
</div>
</div>
</div>
<div id="cell-64" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># low_af = mf_df.groupby('region_id').filter(lambda x: (x['AF_median'] &lt;= 0.5).any())</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>low_af <span class="op">=</span> mf_df.groupby(<span class="st">'region_id'</span>).<span class="bu">filter</span>(<span class="kw">lambda</span> x: (x[<span class="st">'AF'</span>] <span class="op">&lt;=</span> <span class="fl">0.5</span>).<span class="bu">all</span>())</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>low_af</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">region_id</th>
<th data-quarto-table-cell-role="th">sample_id</th>
<th data-quarto-table-cell-role="th">AF</th>
<th data-quarto-table-cell-role="th">FPS</th>
<th data-quarto-table-cell-role="th">FPS_scaled</th>
<th data-quarto-table-cell-role="th">FPS_var</th>
<th data-quarto-table-cell-role="th">FPS_scaled_var</th>
<th data-quarto-table-cell-role="th">AF_var</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>chr1:1130413-1130423</td>
<td>2GAMBDQ_norm</td>
<td>0.250000</td>
<td>0.15151</td>
<td>0.070994</td>
<td>0.001668</td>
<td>0.000338</td>
<td>0.004728</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>chr1:1130413-1130423</td>
<td>98JKPD8_lumA</td>
<td>0.181818</td>
<td>0.11471</td>
<td>0.050516</td>
<td>0.001668</td>
<td>0.000338</td>
<td>0.004728</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>chr1:1130413-1130423</td>
<td>ANAB5F7_basal</td>
<td>0.062500</td>
<td>0.04786</td>
<td>0.024545</td>
<td>0.001668</td>
<td>0.000338</td>
<td>0.004728</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>chr1:1130413-1130423</td>
<td>PU24GB8_lumB</td>
<td>0.131579</td>
<td>0.14384</td>
<td>0.067359</td>
<td>0.001668</td>
<td>0.000338</td>
<td>0.004728</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>chr1:1130413-1130423</td>
<td>S6R691V_her2</td>
<td>0.147059</td>
<td>0.11338</td>
<td>0.056445</td>
<td>0.001668</td>
<td>0.000338</td>
<td>0.004728</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3205</td>
<td>chrX:74182172-74182182</td>
<td>2GAMBDQ_norm</td>
<td>0.187500</td>
<td>0.07284</td>
<td>0.034131</td>
<td>0.002924</td>
<td>0.000698</td>
<td>0.006726</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3206</td>
<td>chrX:74182172-74182182</td>
<td>98JKPD8_lumA</td>
<td>0.250000</td>
<td>0.09924</td>
<td>0.043703</td>
<td>0.002924</td>
<td>0.000698</td>
<td>0.006726</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3207</td>
<td>chrX:74182172-74182182</td>
<td>ANAB5F7_basal</td>
<td>0.357143</td>
<td>0.01427</td>
<td>0.007318</td>
<td>0.002924</td>
<td>0.000698</td>
<td>0.006726</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3208</td>
<td>chrX:74182172-74182182</td>
<td>PU24GB8_lumB</td>
<td>0.342105</td>
<td>0.12853</td>
<td>0.060189</td>
<td>0.002924</td>
<td>0.000698</td>
<td>0.006726</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3209</td>
<td>chrX:74182172-74182182</td>
<td>S6R691V_her2</td>
<td>0.382353</td>
<td>0.15461</td>
<td>0.076971</td>
<td>0.002924</td>
<td>0.000698</td>
<td>0.006726</td>
</tr>
</tbody>
</table>

<p>1485 rows × 8 columns</p>
</div>
</div>
</div>
<div id="cell-65" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>fig_tuple <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>), dpi<span class="op">=</span><span class="dv">300</span>, num<span class="op">=</span><span class="dv">1</span>, clear<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> fig_tuple</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plot violin plot for high AF set</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'AF'</span>, data<span class="op">=</span>high_af, color<span class="op">=</span><span class="st">'lightgray'</span>, linecolor<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, showfliers<span class="op">=</span><span class="va">False</span>, ax<span class="op">=</span>ax)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>, fontsize<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>sns.stripplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'AF'</span>, data<span class="op">=</span>high_af, hue<span class="op">=</span><span class="st">'sample_id'</span>, size<span class="op">=</span><span class="dv">6</span>, jitter<span class="op">=</span><span class="va">True</span>, palette<span class="op">=</span>springpastel, linewidth<span class="op">=</span><span class="fl">0.5</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>, ax<span class="op">=</span>ax)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot legend outside of the plot</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>plt.legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.225</span>, <span class="dv">1</span>),borderaxespad<span class="op">=</span><span class="dv">0</span>, markerscale<span class="op">=</span><span class="dv">1</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">''</span>)</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Allele frequency (AF)'</span>, fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="variant-freq-analysis-v4_files/figure-html/cell-47-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-66" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot violin plot for low AF set</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.figure(figsize=(10, 10), dpi=300)</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="co"># sns.violinplot(x='region_id', y='AF', data=low_af, color='lightgray', inner='quartile', linecolor='black', linewidth=0.5)</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.xticks(rotation=90, fontsize=2)</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="co"># sns.stripplot(x='region_id', y='AF', data=low_af, hue='sample_id', size=2.5, jitter=True, palette='deep')</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="co"># # plot legend outside of the plot</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.legend(bbox_to_anchor=(1.01, 1),borderaxespad=0, markerscale=2, fontsize=10)</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.xlabel(f'{motif_id} TF binding sites with allelic variants (median AF &lt;= 0.5)', fontsize=8)</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.ylabel('Allele frequency (AF)', fontsize=8)</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.show()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>While we are at it, let’s plot the regions where there was at least one subtype with AF value == 0, which is filtered and saved into a file above.</p>
<div id="cell-68" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot violin plot for sites with at least one subtype with AF == 0</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>), dpi<span class="op">=</span><span class="dv">300</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="co"># sns.boxplot(x='region_id', y='AF', data=atleast_one_zero_af, color='gainsboro', linecolor='black', linewidth=1.5, showfliers=False)</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>, fontsize<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>sns.stripplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'AF'</span>, data<span class="op">=</span>atleast_one_zero_af, hue<span class="op">=</span><span class="st">'sample_id'</span>, size<span class="op">=</span><span class="dv">4</span>, jitter<span class="op">=</span><span class="va">True</span>, palette<span class="op">=</span>springpastel)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="co"># plot legend outside of the plot</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>plt.legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.225</span>, <span class="dv">1</span>),borderaxespad<span class="op">=</span><span class="dv">0</span>, markerscale<span class="op">=</span><span class="dv">2</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="ss">f'</span><span class="sc">{</span>motif_id<span class="sc">}</span><span class="ss"> TF binding sites with allelic variants (at least one subtype with AF = 0)'</span>, fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Allele frequency (AF)'</span>, fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="variant-freq-analysis-v4_files/figure-html/cell-49-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>No clear pattern of enrichment of a specific subtype with high AF compared to the rest can be seen. We can use the subset of these to plot the distribution of the associated FPS values (unscaled).</p>
<div id="cell-70" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fig, ax = plt.subplots(2, 1, figsize=(10, 10), dpi=300, num=1, clear=True)</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="co"># sns.boxplot(x='region_id', y='AF', data=high_af, color='lightgray', linecolor='black', linewidth=1.5, showfliers=False)</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.xticks(rotation=90, fontsize=6)</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co"># sns.stripplot(x='region_id', y='AF', data=high_af, hue='sample_id', size=6, jitter=True, palette=springpastel, linewidth=0.5, edgecolor='black')</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="co"># # plot legend outside of the plot</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.legend(bbox_to_anchor=(1.225, 1),borderaxespad=0, markerscale=1, fontsize=10)</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.xlabel('')</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.ylabel('Allele frequency (AF)', fontsize=8)</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="co"># sns.boxplot(x='region_id', y='AF', data=high_af, color='lightgray', linecolor='black', linewidth=1.5, showfliers=False, ax=ax[0])</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ax[0].tick_params(axis='x', rotation=90, labelsize=6)</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="co"># sns.stripplot(x='region_id', y='AF', data=high_af, hue='sample_id', size=6, jitter=True, palette=springpastel, linewidth=0.5, edgecolor='black', ax=ax[0])</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="co"># # plot legend outside of the plot</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a><span class="co"># ax[0].legend(bbox_to_anchor=(1.225, 1),borderaxespad=0, markerscale=1, fontsize=10)</span></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a><span class="co"># ax[0].set_xlabel('')</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a><span class="co"># ax[0].set_ylabel('Allele frequency (AF)', fontsize=8)</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a><span class="co"># # then plot the scaled FPS values for these sites</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a><span class="co"># # plt.subplot(2, 1, 2)</span></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a><span class="co"># # sns.boxplot(x='region_id', y='FPS_scaled', data=high_af, color='white', linecolor='black', linewidth=1.5, showfliers=False)</span></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a><span class="co"># # plt.xticks(rotation=90, fontsize=6)</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a><span class="co"># # sns.stripplot(x='region_id', y='FPS_scaled', data=high_af, hue='sample_id', size=6, jitter=True, palette=springpastel, legend=False, linewidth=0.5, edgecolor='black')</span></span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a><span class="co"># # plt.xlabel(f'{motif_id} TF binding sites with allelic variants (at least one subtype with AF = 0)', fontsize=10)</span></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a><span class="co"># # plt.ylabel(f'Footprint scores (FPS) (min-max scaled)', fontsize=8)</span></span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a><span class="co"># # plt.subplots_adjust(hspace=0.6)</span></span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a><span class="co"># # plt.show()</span></span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a><span class="co"># sns.boxplot(x='region_id', y='FPS_scaled', data=high_af, color='white', linecolor='black', linewidth=1.5, showfliers=False, ax=ax[1])</span></span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a><span class="co"># ax[1].tick_params(axis='x', rotation=90, labelsize=6)</span></span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a><span class="co"># sns.stripplot(x='region_id', y='FPS_scaled', data=high_af, hue='sample_id', size=6, jitter=True, palette=springpastel, legend=False, linewidth=0.5, edgecolor='black', ax=ax[1])</span></span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a><span class="co"># ax[1].set_xlabel(f'{motif_id} TF binding sites with allelic variants (at least one subtype with AF = 0)', fontsize=10)</span></span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a><span class="co"># ax[1].set_ylabel(f'Footprint scores (FPS) (min-max scaled)', fontsize=8)</span></span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.subplots_adjust(hspace=0.6)</span></span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.show()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Some cancer subtypes appear to not have alternative alleles in certain sites but there is barely any pattern of enrichment in FPS values for any specific subtype.</p>
<p>What is the range of FPS variance in the subset dataframe?</p>
<div id="cell-73" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>high_af[[<span class="st">'FPS_scaled_var'</span>, <span class="st">'AF_var'</span>]].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">FPS_scaled_var</th>
<th data-quarto-table-cell-role="th">AF_var</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>6.350000e+02</td>
<td>635.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>3.486108e-04</td>
<td>0.005244</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>9.050190e-04</td>
<td>0.005475</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>2.684938e-07</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>4.768179e-06</td>
<td>0.000683</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>1.861737e-05</td>
<td>0.003836</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>1.769064e-04</td>
<td>0.007752</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>5.369647e-03</td>
<td>0.022249</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Let’s now apply thresholding onto the FPS scaled data to denoise the dataset even more. There are two strategies:</p>
<ol type="1">
<li>Thresholding by computing the outlier threshold using the IQR method on <code>FPS_scaled_var</code> values.This means we are only keeping regions that show extreme variance in FPS values across subtypes.</li>
<li>Thresholding by computing the mean of <code>FPS_scaled</code> values across subtypes and keeping only regions that have such value above the mean at least in one subtype.</li>
</ol>
<section id="strategy-1-iqr-method" class="level4">
<h4 class="anchored" data-anchor-id="strategy-1-iqr-method">STRATEGY 1: IQR Method</h4>
<div id="cell-76" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># STRATEGY 1: subset high_af for sites with FPS_scaled_var &gt; 75th percentile + 1.5 * IQR</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>iqr <span class="op">=</span> high_af[<span class="st">'FPS_scaled_var'</span>].quantile(q<span class="op">=</span><span class="fl">0.75</span>) <span class="op">-</span> high_af[<span class="st">'FPS_scaled_var'</span>].quantile(q<span class="op">=</span><span class="fl">0.25</span>)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>high_af_fps_outliers <span class="op">=</span> high_af[high_af[<span class="st">'FPS_scaled_var'</span>] <span class="op">&gt;</span> high_af[<span class="st">'FPS_scaled_var'</span>].quantile(q<span class="op">=</span><span class="fl">0.75</span>) <span class="op">+</span> (<span class="fl">1.5</span> <span class="op">*</span> iqr)]</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>high_af_fps_outliers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">region_id</th>
<th data-quarto-table-cell-role="th">sample_id</th>
<th data-quarto-table-cell-role="th">AF</th>
<th data-quarto-table-cell-role="th">FPS</th>
<th data-quarto-table-cell-role="th">FPS_scaled</th>
<th data-quarto-table-cell-role="th">FPS_var</th>
<th data-quarto-table-cell-role="th">FPS_scaled_var</th>
<th data-quarto-table-cell-role="th">AF_var</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">210</td>
<td>chr1:161766237-161766247</td>
<td>2GAMBDQ_norm</td>
<td>0.875000</td>
<td>0.76865</td>
<td>0.360174</td>
<td>0.022629</td>
<td>0.003065</td>
<td>0.000382</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">211</td>
<td>chr1:161766237-161766247</td>
<td>98JKPD8_lumA</td>
<td>0.833333</td>
<td>0.86762</td>
<td>0.382084</td>
<td>0.022629</td>
<td>0.003065</td>
<td>0.000382</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">212</td>
<td>chr1:161766237-161766247</td>
<td>ANAB5F7_basal</td>
<td>0.852941</td>
<td>0.58857</td>
<td>0.301846</td>
<td>0.022629</td>
<td>0.003065</td>
<td>0.000382</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">213</td>
<td>chr1:161766237-161766247</td>
<td>PU24GB8_lumB</td>
<td>0.868421</td>
<td>0.65888</td>
<td>0.308547</td>
<td>0.022629</td>
<td>0.003065</td>
<td>0.000382</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">214</td>
<td>chr1:161766237-161766247</td>
<td>S6R691V_her2</td>
<td>0.882353</td>
<td>0.48283</td>
<td>0.240372</td>
<td>0.022629</td>
<td>0.003065</td>
<td>0.000382</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3000</td>
<td>chr20:19838653-19838663</td>
<td>2GAMBDQ_norm</td>
<td>0.875000</td>
<td>0.01821</td>
<td>0.008533</td>
<td>0.001915</td>
<td>0.000518</td>
<td>0.011446</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3001</td>
<td>chr20:19838653-19838663</td>
<td>98JKPD8_lumA</td>
<td>0.850000</td>
<td>0.01684</td>
<td>0.007416</td>
<td>0.001915</td>
<td>0.000518</td>
<td>0.011446</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3002</td>
<td>chr20:19838653-19838663</td>
<td>ANAB5F7_basal</td>
<td>0.617647</td>
<td>0.11351</td>
<td>0.058213</td>
<td>0.001915</td>
<td>0.000518</td>
<td>0.011446</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3003</td>
<td>chr20:19838653-19838663</td>
<td>PU24GB8_lumB</td>
<td>0.843750</td>
<td>0.01412</td>
<td>0.006612</td>
<td>0.001915</td>
<td>0.000518</td>
<td>0.011446</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3004</td>
<td>chr20:19838653-19838663</td>
<td>S6R691V_her2</td>
<td>0.852941</td>
<td>0.01385</td>
<td>0.006895</td>
<td>0.001915</td>
<td>0.000518</td>
<td>0.011446</td>
</tr>
</tbody>
</table>

<p>100 rows × 8 columns</p>
</div>
</div>
</div>
<div id="cell-77" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># before discarding, grab all the regions where AF_var == 0; as we already filter out AF == 0, this would return regions where all subtypes have AF == 1, hence zero variance</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co"># af_var_one = high_af_fps_outliers[high_af_fps_outliers['AF_var'] == 0]</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co"># save to file</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co"># af_var_one.to_csv(f'/home/msazizan/hyperspace/gatk-workflow/plotting/output-data/AF-FPS_regionsorted_full_longtable/{motif_id}_afps_longtable_raw_af_one_across_subtypes.tsv', sep='\t', index=False)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-78" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># and then discard sites if it has AF_var == 0 (i.e. all subtypes have AF == 1, as we already filter out raw AF == 0)</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>high_nzaf_outliers <span class="op">=</span> high_af_fps_outliers[high_af_fps_outliers[<span class="st">'AF_var'</span>] <span class="op">!=</span> <span class="dv">0</span>]</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>high_nzaf_outliers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">region_id</th>
<th data-quarto-table-cell-role="th">sample_id</th>
<th data-quarto-table-cell-role="th">AF</th>
<th data-quarto-table-cell-role="th">FPS</th>
<th data-quarto-table-cell-role="th">FPS_scaled</th>
<th data-quarto-table-cell-role="th">FPS_var</th>
<th data-quarto-table-cell-role="th">FPS_scaled_var</th>
<th data-quarto-table-cell-role="th">AF_var</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">210</td>
<td>chr1:161766237-161766247</td>
<td>2GAMBDQ_norm</td>
<td>0.875000</td>
<td>0.76865</td>
<td>0.360174</td>
<td>0.022629</td>
<td>0.003065</td>
<td>0.000382</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">211</td>
<td>chr1:161766237-161766247</td>
<td>98JKPD8_lumA</td>
<td>0.833333</td>
<td>0.86762</td>
<td>0.382084</td>
<td>0.022629</td>
<td>0.003065</td>
<td>0.000382</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">212</td>
<td>chr1:161766237-161766247</td>
<td>ANAB5F7_basal</td>
<td>0.852941</td>
<td>0.58857</td>
<td>0.301846</td>
<td>0.022629</td>
<td>0.003065</td>
<td>0.000382</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">213</td>
<td>chr1:161766237-161766247</td>
<td>PU24GB8_lumB</td>
<td>0.868421</td>
<td>0.65888</td>
<td>0.308547</td>
<td>0.022629</td>
<td>0.003065</td>
<td>0.000382</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">214</td>
<td>chr1:161766237-161766247</td>
<td>S6R691V_her2</td>
<td>0.882353</td>
<td>0.48283</td>
<td>0.240372</td>
<td>0.022629</td>
<td>0.003065</td>
<td>0.000382</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3000</td>
<td>chr20:19838653-19838663</td>
<td>2GAMBDQ_norm</td>
<td>0.875000</td>
<td>0.01821</td>
<td>0.008533</td>
<td>0.001915</td>
<td>0.000518</td>
<td>0.011446</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3001</td>
<td>chr20:19838653-19838663</td>
<td>98JKPD8_lumA</td>
<td>0.850000</td>
<td>0.01684</td>
<td>0.007416</td>
<td>0.001915</td>
<td>0.000518</td>
<td>0.011446</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3002</td>
<td>chr20:19838653-19838663</td>
<td>ANAB5F7_basal</td>
<td>0.617647</td>
<td>0.11351</td>
<td>0.058213</td>
<td>0.001915</td>
<td>0.000518</td>
<td>0.011446</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3003</td>
<td>chr20:19838653-19838663</td>
<td>PU24GB8_lumB</td>
<td>0.843750</td>
<td>0.01412</td>
<td>0.006612</td>
<td>0.001915</td>
<td>0.000518</td>
<td>0.011446</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3004</td>
<td>chr20:19838653-19838663</td>
<td>S6R691V_her2</td>
<td>0.852941</td>
<td>0.01385</td>
<td>0.006895</td>
<td>0.001915</td>
<td>0.000518</td>
<td>0.011446</td>
</tr>
</tbody>
</table>

<p>80 rows × 8 columns</p>
</div>
</div>
</div>
<div id="cell-79" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create color dictionary</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>dutchfield_colordict <span class="op">=</span> {<span class="st">'S6R691V_her2'</span>: <span class="st">"#e60049"</span>, <span class="st">'ANAB5F7_basal'</span>: <span class="st">"#0bb4ff"</span>, <span class="st">'98JKPD8_lumA'</span>: <span class="st">"#87bc45"</span>, <span class="st">'PU24GB8_lumB'</span>: <span class="st">"#ef9b20"</span>, <span class="st">'2GAMBDQ_norm'</span>: <span class="st">"#b33dc6"</span>}</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>), dpi<span class="op">=</span><span class="dv">300</span>)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co"># specify subplot</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'AF'</span>, data<span class="op">=</span>high_nzaf_outliers, color<span class="op">=</span><span class="st">'whitesmoke'</span>, linecolor<span class="op">=</span><span class="st">'black'</span>, showfliers<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>sns.stripplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'AF'</span>, data<span class="op">=</span>high_nzaf_outliers, hue<span class="op">=</span><span class="st">'sample_id'</span>, palette<span class="op">=</span>dutchfield_colordict, size<span class="op">=</span><span class="dv">4</span>, jitter<span class="op">=</span><span class="va">True</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>, fontsize<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">''</span>)</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'AF per site'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="co"># place legend outside of the plot</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>plt.legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.01</span>, <span class="dv">1</span>),borderaxespad<span class="op">=</span><span class="dv">0</span>, markerscale<span class="op">=</span><span class="dv">2</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'AF_var'</span>, data<span class="op">=</span>high_nzaf_outliers, color<span class="op">=</span><span class="st">'darkslateblue'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>, fontsize<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">''</span>)</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'AF variance'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'FPS_scaled'</span>, data<span class="op">=</span>high_nzaf_outliers, color<span class="op">=</span><span class="st">'whitesmoke'</span>, linecolor<span class="op">=</span><span class="st">'black'</span>, showfliers<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>sns.stripplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'FPS_scaled'</span>, data<span class="op">=</span>high_nzaf_outliers, hue<span class="op">=</span><span class="st">'sample_id'</span>, palette<span class="op">=</span>dutchfield_colordict, size<span class="op">=</span><span class="dv">4</span>, jitter<span class="op">=</span><span class="va">True</span>, legend<span class="op">=</span><span class="va">False</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>, fontsize<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">''</span>)</span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Scaled FPS per site'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">4</span>)</span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'FPS_scaled_var'</span>, data<span class="op">=</span>high_nzaf_outliers, color<span class="op">=</span><span class="st">'darkslateblue'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>, fontsize<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="ss">f'</span><span class="sc">{</span>motif_id<span class="sc">}</span><span class="ss"> TF binding sites with allelic variants (AF &gt; 0.5 in all subtypes)'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'FPS Variance'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(hspace<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="variant-freq-analysis-v4_files/figure-html/cell-55-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="strategy-2-thresholding-by-central-fps-value" class="level4">
<h4 class="anchored" data-anchor-id="strategy-2-thresholding-by-central-fps-value">STRATEGY 2: Thresholding by central FPS value</h4>
<p>First, let’s assess whether median or mean is a better measure of central tendency for the FPS values.</p>
<div id="cell-82" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># strategy 2: subset high_af for FPS_scaled &gt; median (of the unsplit dataframe)</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate global median of the FPS scaled for the unsplit dataframe</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>mf_df_s2 <span class="op">=</span> mf_df.copy()</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>mf_df_s2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">region_id</th>
<th data-quarto-table-cell-role="th">sample_id</th>
<th data-quarto-table-cell-role="th">AF</th>
<th data-quarto-table-cell-role="th">FPS</th>
<th data-quarto-table-cell-role="th">FPS_scaled</th>
<th data-quarto-table-cell-role="th">FPS_var</th>
<th data-quarto-table-cell-role="th">FPS_scaled_var</th>
<th data-quarto-table-cell-role="th">AF_var</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>chr1:925405-925415</td>
<td>2GAMBDQ_norm</td>
<td>1.000000</td>
<td>0.05586</td>
<td>0.026175</td>
<td>0.000659</td>
<td>0.000134</td>
<td>0.019970</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>chr1:925405-925415</td>
<td>98JKPD8_lumA</td>
<td>1.000000</td>
<td>0.09540</td>
<td>0.042012</td>
<td>0.000659</td>
<td>0.000134</td>
<td>0.019970</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>chr1:925405-925415</td>
<td>ANAB5F7_basal</td>
<td>0.730769</td>
<td>0.03670</td>
<td>0.018821</td>
<td>0.000659</td>
<td>0.000134</td>
<td>0.019970</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>chr1:925405-925415</td>
<td>PU24GB8_lumB</td>
<td>0.769231</td>
<td>0.05082</td>
<td>0.023798</td>
<td>0.000659</td>
<td>0.000134</td>
<td>0.019970</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>chr1:925405-925415</td>
<td>S6R691V_her2</td>
<td>0.730769</td>
<td>0.09011</td>
<td>0.044860</td>
<td>0.000659</td>
<td>0.000134</td>
<td>0.019970</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3230</td>
<td>chrX:150849074-150849084</td>
<td>2GAMBDQ_norm</td>
<td>0.750000</td>
<td>0.20522</td>
<td>0.096162</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3231</td>
<td>chrX:150849074-150849084</td>
<td>98JKPD8_lumA</td>
<td>0.500000</td>
<td>0.34392</td>
<td>0.151456</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3232</td>
<td>chrX:150849074-150849084</td>
<td>ANAB5F7_basal</td>
<td>0.600000</td>
<td>0.07363</td>
<td>0.037761</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3233</td>
<td>chrX:150849074-150849084</td>
<td>PU24GB8_lumB</td>
<td>0.605263</td>
<td>0.24735</td>
<td>0.115831</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3234</td>
<td>chrX:150849074-150849084</td>
<td>S6R691V_her2</td>
<td>0.588235</td>
<td>0.35995</td>
<td>0.179197</td>
<td>0.013487</td>
<td>0.002941</td>
<td>0.008072</td>
</tr>
</tbody>
</table>

<p>3235 rows × 8 columns</p>
</div>
</div>
</div>
<div id="cell-83" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>fps_scaled_global_median <span class="op">=</span> mf_df_s2[<span class="st">'FPS_scaled'</span>].median()</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(fps_scaled_global_median)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>fps_scaled_global_mean <span class="op">=</span> mf_df_s2[<span class="st">'FPS_scaled'</span>].mean()</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(fps_scaled_global_mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.013078051271958801
0.04597799805605853</code></pre>
</div>
</div>
<div id="cell-84" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot fps_scaled distribution</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>), dpi<span class="op">=</span><span class="dv">300</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>sns.kdeplot(data<span class="op">=</span>mf_df_s2, x<span class="op">=</span><span class="st">"AF"</span>, hue<span class="op">=</span><span class="st">"sample_id"</span>, fill<span class="op">=</span><span class="va">False</span>, common_norm<span class="op">=</span><span class="va">False</span>, alpha<span class="op">=</span><span class="fl">.5</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=</span>mf_df_s2[<span class="st">'AF'</span>].mean(), color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>plt.text(mf_df_s2[<span class="st">'AF'</span>].mean(), plt.gca().get_ylim()[<span class="dv">1</span>]<span class="op">*</span><span class="fl">0.9</span>, <span class="st">'mean'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=</span>mf_df_s2[<span class="st">'AF'</span>].median(), color<span class="op">=</span><span class="st">'blue'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>plt.text(mf_df_s2[<span class="st">'AF'</span>].median(), plt.gca().get_ylim()[<span class="dv">1</span>]<span class="op">*</span><span class="fl">0.8</span>, <span class="st">'median'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>sns.kdeplot(data<span class="op">=</span>mf_df_s2, x<span class="op">=</span><span class="st">"FPS_scaled"</span>, hue<span class="op">=</span><span class="st">"sample_id"</span>, fill<span class="op">=</span><span class="va">False</span>, common_norm<span class="op">=</span><span class="va">False</span>, alpha<span class="op">=</span><span class="fl">.5</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=</span>fps_scaled_global_mean, color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>plt.text(fps_scaled_global_mean, plt.gca().get_ylim()[<span class="dv">1</span>]<span class="op">*</span><span class="fl">0.9</span>, <span class="st">'mean'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=</span>fps_scaled_global_median, color<span class="op">=</span><span class="st">'blue'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>plt.text(fps_scaled_global_median, plt.gca().get_ylim()[<span class="dv">1</span>]<span class="op">*</span><span class="fl">0.8</span>, <span class="st">'median'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="variant-freq-analysis-v4_files/figure-html/cell-58-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>It seems like using mean is more stringent than using median to filter out noise. Let’s use the mean.</p>
<p>Now we can filter the dataframes to retain only rows that have <code>FPS_scaled</code> values above the mean.</p>
<div id="cell-86" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># subset region_id with FPS_scaled &gt; mean</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="co"># first subset per region_id and then filter for those with FPS_scaled &gt; mean for any subtype</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>high_af_fpsgtmean_any <span class="op">=</span> high_af.groupby(<span class="st">'region_id'</span>).<span class="bu">filter</span>(<span class="kw">lambda</span> x: (x[<span class="st">'FPS_scaled'</span>] <span class="op">&gt;</span> fps_scaled_global_mean).<span class="bu">any</span>())</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>high_af_fpsgtmean_any</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">region_id</th>
<th data-quarto-table-cell-role="th">sample_id</th>
<th data-quarto-table-cell-role="th">AF</th>
<th data-quarto-table-cell-role="th">FPS</th>
<th data-quarto-table-cell-role="th">FPS_scaled</th>
<th data-quarto-table-cell-role="th">FPS_var</th>
<th data-quarto-table-cell-role="th">FPS_scaled_var</th>
<th data-quarto-table-cell-role="th">AF_var</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">110</td>
<td>chr1:52055381-52055391</td>
<td>2GAMBDQ_norm</td>
<td>1.000000</td>
<td>0.17739</td>
<td>0.083121</td>
<td>0.001060</td>
<td>0.000310</td>
<td>0.002768</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">111</td>
<td>chr1:52055381-52055391</td>
<td>98JKPD8_lumA</td>
<td>1.000000</td>
<td>0.25634</td>
<td>0.112887</td>
<td>0.001060</td>
<td>0.000310</td>
<td>0.002768</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">112</td>
<td>chr1:52055381-52055391</td>
<td>ANAB5F7_basal</td>
<td>0.941176</td>
<td>0.24529</td>
<td>0.125796</td>
<td>0.001060</td>
<td>0.000310</td>
<td>0.002768</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">113</td>
<td>chr1:52055381-52055391</td>
<td>PU24GB8_lumB</td>
<td>1.000000</td>
<td>0.21208</td>
<td>0.099315</td>
<td>0.001060</td>
<td>0.000310</td>
<td>0.002768</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">114</td>
<td>chr1:52055381-52055391</td>
<td>S6R691V_her2</td>
<td>0.882353</td>
<td>0.24599</td>
<td>0.122464</td>
<td>0.001060</td>
<td>0.000310</td>
<td>0.002768</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3145</td>
<td>chr22:31530732-31530742</td>
<td>2GAMBDQ_norm</td>
<td>0.812500</td>
<td>0.21078</td>
<td>0.098767</td>
<td>0.000238</td>
<td>0.000146</td>
<td>0.008418</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3146</td>
<td>chr22:31530732-31530742</td>
<td>98JKPD8_lumA</td>
<td>0.875000</td>
<td>0.21306</td>
<td>0.093828</td>
<td>0.000238</td>
<td>0.000146</td>
<td>0.008418</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3147</td>
<td>chr22:31530732-31530742</td>
<td>ANAB5F7_basal</td>
<td>0.735294</td>
<td>0.24335</td>
<td>0.124801</td>
<td>0.000238</td>
<td>0.000146</td>
<td>0.008418</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3148</td>
<td>chr22:31530732-31530742</td>
<td>PU24GB8_lumB</td>
<td>0.631579</td>
<td>0.21487</td>
<td>0.100621</td>
<td>0.000238</td>
<td>0.000146</td>
<td>0.008418</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3149</td>
<td>chr22:31530732-31530742</td>
<td>S6R691V_her2</td>
<td>0.735294</td>
<td>0.20292</td>
<td>0.101022</td>
<td>0.000238</td>
<td>0.000146</td>
<td>0.008418</td>
</tr>
</tbody>
</table>

<p>165 rows × 8 columns</p>
</div>
</div>
</div>
<div id="cell-87" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create color dictionary</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>dutchfield_colordict <span class="op">=</span> {<span class="st">'S6R691V_her2'</span>: <span class="st">"#e60049"</span>, <span class="st">'ANAB5F7_basal'</span>: <span class="st">"#0bb4ff"</span>, <span class="st">'98JKPD8_lumA'</span>: <span class="st">"#87bc45"</span>, <span class="st">'PU24GB8_lumB'</span>: <span class="st">"#ef9b20"</span>, <span class="st">'2GAMBDQ_norm'</span>: <span class="st">"#b33dc6"</span>}</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>), dpi<span class="op">=</span><span class="dv">300</span>)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co"># specify subplot</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'AF'</span>, data<span class="op">=</span>high_af_fpsgtmean_any, color<span class="op">=</span><span class="st">'whitesmoke'</span>, linecolor<span class="op">=</span><span class="st">'black'</span>, showfliers<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>sns.stripplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'AF'</span>, data<span class="op">=</span>high_af_fpsgtmean_any, hue<span class="op">=</span><span class="st">'sample_id'</span>, palette<span class="op">=</span>dutchfield_colordict, size<span class="op">=</span><span class="dv">4</span>, jitter<span class="op">=</span><span class="va">True</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>plt.xticks(ticks<span class="op">=</span>plt.xticks()[<span class="dv">0</span>], labels<span class="op">=</span>[])</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">''</span>)</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>ylabel <span class="op">=</span> textwrap.fill(<span class="st">'AF per site'</span>, width<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>plt.ylabel(ylabel, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a><span class="co"># place legend outside of the plot</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>plt.legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.01</span>, <span class="dv">1</span>),borderaxespad<span class="op">=</span><span class="dv">0</span>, markerscale<span class="op">=</span><span class="dv">2</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'AF_var'</span>, data<span class="op">=</span>high_af_fpsgtmean_any, color<span class="op">=</span><span class="st">'darkslateblue'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>plt.xticks(ticks<span class="op">=</span>plt.xticks()[<span class="dv">0</span>], labels<span class="op">=</span>[])</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">''</span>)</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>ylabel <span class="op">=</span> textwrap.fill(<span class="st">'AF variance'</span>, width<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>plt.ylabel(ylabel, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'FPS_scaled'</span>, data<span class="op">=</span>high_af_fpsgtmean_any, color<span class="op">=</span><span class="st">'whitesmoke'</span>, linecolor<span class="op">=</span><span class="st">'black'</span>, showfliers<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>sns.stripplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'FPS_scaled'</span>, data<span class="op">=</span>high_af_fpsgtmean_any, hue<span class="op">=</span><span class="st">'sample_id'</span>, palette<span class="op">=</span>dutchfield_colordict, size<span class="op">=</span><span class="dv">4</span>, jitter<span class="op">=</span><span class="va">True</span>, legend<span class="op">=</span><span class="va">False</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a><span class="co"># plot horizontal line at fps_scaled_global_median</span></span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span>fps_scaled_global_mean, color<span class="op">=</span><span class="st">'black'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a>plt.xticks(ticks<span class="op">=</span>plt.xticks()[<span class="dv">0</span>], labels<span class="op">=</span>[])</span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">''</span>)</span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a>ylabel <span class="op">=</span> textwrap.fill(<span class="st">'Scaled FPS per site'</span>, width<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a>plt.ylabel(ylabel, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">4</span>)</span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'FPS_scaled_var'</span>, data<span class="op">=</span>high_af_fpsgtmean_any, color<span class="op">=</span><span class="st">'darkslateblue'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>, fontsize<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb62-35"><a href="#cb62-35" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="ss">f'</span><span class="sc">{</span>motif_id<span class="sc">}</span><span class="ss"> TF binding sites with allelic variants (AF &gt; 0.5 across subtypes)'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb62-36"><a href="#cb62-36" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Scaled FPS variance'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb62-37"><a href="#cb62-37" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(hspace<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb62-38"><a href="#cb62-38" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="variant-freq-analysis-v4_files/figure-html/cell-60-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>‘any’ FPS scaled value does not seem to really retain any highly variable sites across subtypes (that spans across the mean value in the plot) so let’s retain only sites that have <code>all</code> FPS scaled values above the mean.</p>
<div id="cell-89" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># subset region_id with FPS_scaled &gt; mean</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co"># subset per region_id and then filter for those with FPS_scaled &gt; mean for all subtype</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>high_af_fpsgtmean_all <span class="op">=</span> high_af.groupby(<span class="st">'region_id'</span>).<span class="bu">filter</span>(<span class="kw">lambda</span> x: (x[<span class="st">'FPS_scaled'</span>] <span class="op">&gt;</span> fps_scaled_global_mean).<span class="bu">all</span>())</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>high_af_fpsgtmean_all</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">region_id</th>
<th data-quarto-table-cell-role="th">sample_id</th>
<th data-quarto-table-cell-role="th">AF</th>
<th data-quarto-table-cell-role="th">FPS</th>
<th data-quarto-table-cell-role="th">FPS_scaled</th>
<th data-quarto-table-cell-role="th">FPS_var</th>
<th data-quarto-table-cell-role="th">FPS_scaled_var</th>
<th data-quarto-table-cell-role="th">AF_var</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">110</td>
<td>chr1:52055381-52055391</td>
<td>2GAMBDQ_norm</td>
<td>1.000000</td>
<td>0.17739</td>
<td>0.083121</td>
<td>0.001060</td>
<td>0.000310</td>
<td>0.002768</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">111</td>
<td>chr1:52055381-52055391</td>
<td>98JKPD8_lumA</td>
<td>1.000000</td>
<td>0.25634</td>
<td>0.112887</td>
<td>0.001060</td>
<td>0.000310</td>
<td>0.002768</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">112</td>
<td>chr1:52055381-52055391</td>
<td>ANAB5F7_basal</td>
<td>0.941176</td>
<td>0.24529</td>
<td>0.125796</td>
<td>0.001060</td>
<td>0.000310</td>
<td>0.002768</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">113</td>
<td>chr1:52055381-52055391</td>
<td>PU24GB8_lumB</td>
<td>1.000000</td>
<td>0.21208</td>
<td>0.099315</td>
<td>0.001060</td>
<td>0.000310</td>
<td>0.002768</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">114</td>
<td>chr1:52055381-52055391</td>
<td>S6R691V_her2</td>
<td>0.882353</td>
<td>0.24599</td>
<td>0.122464</td>
<td>0.001060</td>
<td>0.000310</td>
<td>0.002768</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3145</td>
<td>chr22:31530732-31530742</td>
<td>2GAMBDQ_norm</td>
<td>0.812500</td>
<td>0.21078</td>
<td>0.098767</td>
<td>0.000238</td>
<td>0.000146</td>
<td>0.008418</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3146</td>
<td>chr22:31530732-31530742</td>
<td>98JKPD8_lumA</td>
<td>0.875000</td>
<td>0.21306</td>
<td>0.093828</td>
<td>0.000238</td>
<td>0.000146</td>
<td>0.008418</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3147</td>
<td>chr22:31530732-31530742</td>
<td>ANAB5F7_basal</td>
<td>0.735294</td>
<td>0.24335</td>
<td>0.124801</td>
<td>0.000238</td>
<td>0.000146</td>
<td>0.008418</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3148</td>
<td>chr22:31530732-31530742</td>
<td>PU24GB8_lumB</td>
<td>0.631579</td>
<td>0.21487</td>
<td>0.100621</td>
<td>0.000238</td>
<td>0.000146</td>
<td>0.008418</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3149</td>
<td>chr22:31530732-31530742</td>
<td>S6R691V_her2</td>
<td>0.735294</td>
<td>0.20292</td>
<td>0.101022</td>
<td>0.000238</td>
<td>0.000146</td>
<td>0.008418</td>
</tr>
</tbody>
</table>

<p>100 rows × 8 columns</p>
</div>
</div>
</div>
<div id="cell-90" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>dutchfield_colordict <span class="op">=</span> {<span class="st">'S6R691V_her2'</span>: <span class="st">"#e60049"</span>, <span class="st">'ANAB5F7_basal'</span>: <span class="st">"#0bb4ff"</span>, <span class="st">'98JKPD8_lumA'</span>: <span class="st">"#87bc45"</span>, <span class="st">'PU24GB8_lumB'</span>: <span class="st">"#ef9b20"</span>, <span class="st">'2GAMBDQ_norm'</span>: <span class="st">"#b33dc6"</span>}</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>), dpi<span class="op">=</span><span class="dv">300</span>)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="co"># specify subplot</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'AF'</span>, data<span class="op">=</span>high_af_fpsgtmean_all, color<span class="op">=</span><span class="st">'whitesmoke'</span>, linecolor<span class="op">=</span><span class="st">'black'</span>, showfliers<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>sns.stripplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'AF'</span>, data<span class="op">=</span>high_af_fpsgtmean_all, hue<span class="op">=</span><span class="st">'sample_id'</span>, palette<span class="op">=</span>dutchfield_colordict, size<span class="op">=</span><span class="dv">4</span>, jitter<span class="op">=</span><span class="va">True</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>plt.xticks(ticks<span class="op">=</span>plt.xticks()[<span class="dv">0</span>], labels<span class="op">=</span>[])</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">''</span>)</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>ylabel <span class="op">=</span> textwrap.fill(<span class="st">'AF per site'</span>, width<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(ylabel, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a><span class="co"># place legend outside of the plot</span></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>plt.legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.01</span>, <span class="dv">1</span>),borderaxespad<span class="op">=</span><span class="dv">0</span>, markerscale<span class="op">=</span><span class="dv">2</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'AF_var'</span>, data<span class="op">=</span>high_af_fpsgtmean_all, color<span class="op">=</span><span class="st">'darkslateblue'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>plt.xticks(ticks<span class="op">=</span>plt.xticks()[<span class="dv">0</span>], labels<span class="op">=</span>[])</span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">''</span>)</span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>ylabel <span class="op">=</span> textwrap.fill(<span class="st">'AF variance'</span>, width<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>plt.ylabel(ylabel, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'FPS_scaled'</span>, data<span class="op">=</span>high_af_fpsgtmean_all, color<span class="op">=</span><span class="st">'whitesmoke'</span>, linecolor<span class="op">=</span><span class="st">'black'</span>, showfliers<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a>sns.stripplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'FPS_scaled'</span>, data<span class="op">=</span>high_af_fpsgtmean_all, hue<span class="op">=</span><span class="st">'sample_id'</span>, palette<span class="op">=</span>dutchfield_colordict, size<span class="op">=</span><span class="dv">4</span>, jitter<span class="op">=</span><span class="va">True</span>, legend<span class="op">=</span><span class="va">False</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a><span class="co"># plot horizontal line at fps_scaled_global_mean</span></span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span>fps_scaled_global_mean, color<span class="op">=</span><span class="st">'black'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a>plt.xticks(ticks<span class="op">=</span>plt.xticks()[<span class="dv">0</span>], labels<span class="op">=</span>[])</span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">''</span>)</span>
<span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a>ylabel <span class="op">=</span> textwrap.fill(<span class="st">'Scaled FPS per site'</span>, width<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a>plt.ylabel(ylabel, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb64-30"><a href="#cb64-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-31"><a href="#cb64-31" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">4</span>)</span>
<span id="cb64-32"><a href="#cb64-32" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'FPS_scaled_var'</span>, data<span class="op">=</span>high_af_fpsgtmean_all, color<span class="op">=</span><span class="st">'darkslateblue'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb64-33"><a href="#cb64-33" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>, fontsize<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb64-34"><a href="#cb64-34" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="ss">f'</span><span class="sc">{</span>motif_id<span class="sc">}</span><span class="ss"> TF binding sites with allelic variants (median AF &gt; 0.5)'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb64-35"><a href="#cb64-35" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Scaled FPS variance'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb64-36"><a href="#cb64-36" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(hspace<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb64-37"><a href="#cb64-37" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="variant-freq-analysis-v4_files/figure-html/cell-62-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Now that it looks pretty valid, we would also like to subset the unsplit dataframe for FPS values that are below the mean across all subtypes with high AF values as well as FPS values that are above and below the mean across all subtypes with low AF values.</p>
<div id="cell-92" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># subset per region_id and then filter for those with FPS_scaled &lt; mean for all subtype</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>high_af_fpsltmean_all <span class="op">=</span> high_af.groupby(<span class="st">'region_id'</span>).<span class="bu">filter</span>(<span class="kw">lambda</span> x: (x[<span class="st">'FPS_scaled'</span>] <span class="op">&lt;=</span> fps_scaled_global_mean).<span class="bu">all</span>())</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>high_af_fpsltmean_all</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">region_id</th>
<th data-quarto-table-cell-role="th">sample_id</th>
<th data-quarto-table-cell-role="th">AF</th>
<th data-quarto-table-cell-role="th">FPS</th>
<th data-quarto-table-cell-role="th">FPS_scaled</th>
<th data-quarto-table-cell-role="th">FPS_var</th>
<th data-quarto-table-cell-role="th">FPS_scaled_var</th>
<th data-quarto-table-cell-role="th">AF_var</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>chr1:925405-925415</td>
<td>2GAMBDQ_norm</td>
<td>1.000000</td>
<td>0.05586</td>
<td>0.026175</td>
<td>0.000659</td>
<td>0.000134</td>
<td>0.019970</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>chr1:925405-925415</td>
<td>98JKPD8_lumA</td>
<td>1.000000</td>
<td>0.09540</td>
<td>0.042012</td>
<td>0.000659</td>
<td>0.000134</td>
<td>0.019970</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>chr1:925405-925415</td>
<td>ANAB5F7_basal</td>
<td>0.730769</td>
<td>0.03670</td>
<td>0.018821</td>
<td>0.000659</td>
<td>0.000134</td>
<td>0.019970</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>chr1:925405-925415</td>
<td>PU24GB8_lumB</td>
<td>0.769231</td>
<td>0.05082</td>
<td>0.023798</td>
<td>0.000659</td>
<td>0.000134</td>
<td>0.019970</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>chr1:925405-925415</td>
<td>S6R691V_her2</td>
<td>0.730769</td>
<td>0.09011</td>
<td>0.044860</td>
<td>0.000659</td>
<td>0.000134</td>
<td>0.019970</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3200</td>
<td>chrX:34275969-34275979</td>
<td>2GAMBDQ_norm</td>
<td>0.857143</td>
<td>0.02658</td>
<td>0.012455</td>
<td>0.000088</td>
<td>0.000019</td>
<td>0.021762</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3201</td>
<td>chrX:34275969-34275979</td>
<td>98JKPD8_lumA</td>
<td>0.611111</td>
<td>0.03378</td>
<td>0.014876</td>
<td>0.000088</td>
<td>0.000019</td>
<td>0.021762</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3202</td>
<td>chrX:34275969-34275979</td>
<td>ANAB5F7_basal</td>
<td>0.888889</td>
<td>0.01175</td>
<td>0.006026</td>
<td>0.000088</td>
<td>0.000019</td>
<td>0.021762</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3203</td>
<td>chrX:34275969-34275979</td>
<td>PU24GB8_lumB</td>
<td>1.000000</td>
<td>0.02894</td>
<td>0.013552</td>
<td>0.000088</td>
<td>0.000019</td>
<td>0.021762</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3204</td>
<td>chrX:34275969-34275979</td>
<td>S6R691V_her2</td>
<td>0.750000</td>
<td>0.03548</td>
<td>0.017663</td>
<td>0.000088</td>
<td>0.000019</td>
<td>0.021762</td>
</tr>
</tbody>
</table>

<p>470 rows × 8 columns</p>
</div>
</div>
</div>
<div id="cell-93" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># subset per region_id and then filter for those with FPS_scaled &lt; mean for all subtype</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>low_af_fpsltmean_all <span class="op">=</span> low_af.groupby(<span class="st">'region_id'</span>).<span class="bu">filter</span>(<span class="kw">lambda</span> x: (x[<span class="st">'FPS_scaled'</span>] <span class="op">&lt;=</span> fps_scaled_global_mean).<span class="bu">all</span>())</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>low_af_fpsltmean_all</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">region_id</th>
<th data-quarto-table-cell-role="th">sample_id</th>
<th data-quarto-table-cell-role="th">AF</th>
<th data-quarto-table-cell-role="th">FPS</th>
<th data-quarto-table-cell-role="th">FPS_scaled</th>
<th data-quarto-table-cell-role="th">FPS_var</th>
<th data-quarto-table-cell-role="th">FPS_scaled_var</th>
<th data-quarto-table-cell-role="th">AF_var</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>chr1:1225277-1225287</td>
<td>2GAMBDQ_norm</td>
<td>0.071429</td>
<td>0.02657</td>
<td>0.012450</td>
<td>0.000127</td>
<td>0.000039</td>
<td>0.000139</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>chr1:1225277-1225287</td>
<td>98JKPD8_lumA</td>
<td>0.090909</td>
<td>0.01792</td>
<td>0.007892</td>
<td>0.000127</td>
<td>0.000039</td>
<td>0.000139</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>chr1:1225277-1225287</td>
<td>ANAB5F7_basal</td>
<td>0.062500</td>
<td>0.04624</td>
<td>0.023714</td>
<td>0.000127</td>
<td>0.000039</td>
<td>0.000139</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>chr1:1225277-1225287</td>
<td>PU24GB8_lumB</td>
<td>0.078947</td>
<td>0.01957</td>
<td>0.009164</td>
<td>0.000127</td>
<td>0.000039</td>
<td>0.000139</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>chr1:1225277-1225287</td>
<td>S6R691V_her2</td>
<td>0.088235</td>
<td>0.02729</td>
<td>0.013586</td>
<td>0.000127</td>
<td>0.000039</td>
<td>0.000139</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3185</td>
<td>chr22:47019709-47019719</td>
<td>2GAMBDQ_norm</td>
<td>0.500000</td>
<td>0.01748</td>
<td>0.008191</td>
<td>0.000007</td>
<td>0.000002</td>
<td>0.023916</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3186</td>
<td>chr22:47019709-47019719</td>
<td>98JKPD8_lumA</td>
<td>0.250000</td>
<td>0.01116</td>
<td>0.004915</td>
<td>0.000007</td>
<td>0.000002</td>
<td>0.023916</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3187</td>
<td>chr22:47019709-47019719</td>
<td>ANAB5F7_basal</td>
<td>0.176471</td>
<td>0.01336</td>
<td>0.006852</td>
<td>0.000007</td>
<td>0.000002</td>
<td>0.023916</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3188</td>
<td>chr22:47019709-47019719</td>
<td>PU24GB8_lumB</td>
<td>0.083333</td>
<td>0.01285</td>
<td>0.006018</td>
<td>0.000007</td>
<td>0.000002</td>
<td>0.023916</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3189</td>
<td>chr22:47019709-47019719</td>
<td>S6R691V_her2</td>
<td>0.250000</td>
<td>0.01685</td>
<td>0.008389</td>
<td>0.000007</td>
<td>0.000002</td>
<td>0.023916</td>
</tr>
</tbody>
</table>

<p>1015 rows × 8 columns</p>
</div>
</div>
</div>
<div id="cell-94" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># subset per region_id and then filter for those with FPS_scaled &lt; mean for all subtype</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>low_af_fpsgtmean_all <span class="op">=</span> low_af.groupby(<span class="st">'region_id'</span>).<span class="bu">filter</span>(<span class="kw">lambda</span> x: (x[<span class="st">'FPS_scaled'</span>] <span class="op">&gt;</span> fps_scaled_global_mean).<span class="bu">all</span>())</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>low_af_fpsgtmean_all</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="63">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">region_id</th>
<th data-quarto-table-cell-role="th">sample_id</th>
<th data-quarto-table-cell-role="th">AF</th>
<th data-quarto-table-cell-role="th">FPS</th>
<th data-quarto-table-cell-role="th">FPS_scaled</th>
<th data-quarto-table-cell-role="th">FPS_var</th>
<th data-quarto-table-cell-role="th">FPS_scaled_var</th>
<th data-quarto-table-cell-role="th">AF_var</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">15</td>
<td>chr1:3900825-3900835</td>
<td>2GAMBDQ_norm</td>
<td>0.125000</td>
<td>1.76533</td>
<td>0.827197</td>
<td>0.023987</td>
<td>0.002421</td>
<td>0.002187</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16</td>
<td>chr1:3900825-3900835</td>
<td>98JKPD8_lumA</td>
<td>0.041667</td>
<td>1.95879</td>
<td>0.862614</td>
<td>0.023987</td>
<td>0.002421</td>
<td>0.002187</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17</td>
<td>chr1:3900825-3900835</td>
<td>ANAB5F7_basal</td>
<td>0.147059</td>
<td>1.73899</td>
<td>0.891835</td>
<td>0.023987</td>
<td>0.002421</td>
<td>0.002187</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">18</td>
<td>chr1:3900825-3900835</td>
<td>PU24GB8_lumB</td>
<td>0.052632</td>
<td>1.97913</td>
<td>0.926806</td>
<td>0.023987</td>
<td>0.002421</td>
<td>0.002187</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">19</td>
<td>chr1:3900825-3900835</td>
<td>S6R691V_her2</td>
<td>0.117647</td>
<td>1.61461</td>
<td>0.803816</td>
<td>0.023987</td>
<td>0.002421</td>
<td>0.002187</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3170</td>
<td>chr22:41946757-41946767</td>
<td>2GAMBDQ_norm</td>
<td>0.062500</td>
<td>0.49960</td>
<td>0.234102</td>
<td>0.003915</td>
<td>0.001714</td>
<td>0.002468</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3171</td>
<td>chr22:41946757-41946767</td>
<td>98JKPD8_lumA</td>
<td>0.166667</td>
<td>0.44847</td>
<td>0.197498</td>
<td>0.003915</td>
<td>0.001714</td>
<td>0.002468</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3172</td>
<td>chr22:41946757-41946767</td>
<td>ANAB5F7_basal</td>
<td>0.147059</td>
<td>0.60331</td>
<td>0.309406</td>
<td>0.003915</td>
<td>0.001714</td>
<td>0.002468</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3173</td>
<td>chr22:41946757-41946767</td>
<td>PU24GB8_lumB</td>
<td>0.131579</td>
<td>0.51443</td>
<td>0.240902</td>
<td>0.003915</td>
<td>0.001714</td>
<td>0.002468</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3174</td>
<td>chr22:41946757-41946767</td>
<td>S6R691V_her2</td>
<td>0.058824</td>
<td>0.45316</td>
<td>0.225601</td>
<td>0.003915</td>
<td>0.001714</td>
<td>0.002468</td>
</tr>
</tbody>
</table>

<p>270 rows × 8 columns</p>
</div>
</div>
</div>
<p>Now we can sort the dataframe by <code>region_id</code> based on the descending order of <code>FPS_scaled_var</code> values.</p>
<div id="cell-96" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co">### strat 1 dataframe</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>high_af_uniq_reg <span class="op">=</span> high_nzaf_outliers[[<span class="st">'region_id'</span>, <span class="st">'AF_var'</span>, <span class="st">'FPS_scaled_var'</span>]].drop_duplicates()</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="co"># sort the region_id in the filtered high_af dataframe based on descending order of FPS_scaled_var</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>fpsvar_uniqsort <span class="op">=</span> high_af_uniq_reg.sort_values(by<span class="op">=</span><span class="st">'FPS_scaled_var'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the region_id from the high_af_fps_var_df_uniqsort dataframe</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>sorted_region_ids <span class="op">=</span> fpsvar_uniqsort[<span class="st">'region_id'</span>]</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Change 'region_id' to a categorical variable with the categories ordered by 'sorted_region_ids'</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>df_copy <span class="op">=</span> high_nzaf_outliers.copy()</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>df_copy[<span class="st">'region_id'</span>] <span class="op">=</span> pd.Categorical(high_nzaf_outliers[<span class="st">'region_id'</span>], categories<span class="op">=</span>sorted_region_ids, ordered<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the DataFrame</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>high_nzaf_filtered <span class="op">=</span> df_copy[df_copy[<span class="st">'region_id'</span>].isin(sorted_region_ids)]</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort the DataFrame by 'region_id'</span></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>high_nzaf_filtered <span class="op">=</span> high_nzaf_filtered.sort_values(<span class="st">'region_id'</span>)</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>high_nzaf_filtered</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">region_id</th>
<th data-quarto-table-cell-role="th">sample_id</th>
<th data-quarto-table-cell-role="th">AF</th>
<th data-quarto-table-cell-role="th">FPS</th>
<th data-quarto-table-cell-role="th">FPS_scaled</th>
<th data-quarto-table-cell-role="th">FPS_var</th>
<th data-quarto-table-cell-role="th">FPS_scaled_var</th>
<th data-quarto-table-cell-role="th">AF_var</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2495</td>
<td>chr16:11915752-11915762</td>
<td>2GAMBDQ_norm</td>
<td>1.000000</td>
<td>0.58711</td>
<td>0.275108</td>
<td>0.033973</td>
<td>0.005370</td>
<td>0.001758</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2496</td>
<td>chr16:11915752-11915762</td>
<td>98JKPD8_lumA</td>
<td>0.958333</td>
<td>0.94151</td>
<td>0.414623</td>
<td>0.033973</td>
<td>0.005370</td>
<td>0.001758</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2497</td>
<td>chr16:11915752-11915762</td>
<td>ANAB5F7_basal</td>
<td>1.000000</td>
<td>0.64275</td>
<td>0.329632</td>
<td>0.033973</td>
<td>0.005370</td>
<td>0.001758</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2498</td>
<td>chr16:11915752-11915762</td>
<td>PU24GB8_lumB</td>
<td>0.921053</td>
<td>0.93861</td>
<td>0.439541</td>
<td>0.033973</td>
<td>0.005370</td>
<td>0.001758</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2499</td>
<td>chr16:11915752-11915762</td>
<td>S6R691V_her2</td>
<td>0.911765</td>
<td>0.58832</td>
<td>0.292889</td>
<td>0.033973</td>
<td>0.005370</td>
<td>0.001758</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1758</td>
<td>chr10:35899143-35899153</td>
<td>PU24GB8_lumB</td>
<td>0.954545</td>
<td>0.01006</td>
<td>0.004711</td>
<td>0.001626</td>
<td>0.000437</td>
<td>0.011600</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1757</td>
<td>chr10:35899143-35899153</td>
<td>ANAB5F7_basal</td>
<td>0.676471</td>
<td>0.10266</td>
<td>0.052649</td>
<td>0.001626</td>
<td>0.000437</td>
<td>0.011600</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1756</td>
<td>chr10:35899143-35899153</td>
<td>98JKPD8_lumA</td>
<td>0.888889</td>
<td>0.01277</td>
<td>0.005624</td>
<td>0.001626</td>
<td>0.000437</td>
<td>0.011600</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1755</td>
<td>chr10:35899143-35899153</td>
<td>2GAMBDQ_norm</td>
<td>0.812500</td>
<td>0.02357</td>
<td>0.011044</td>
<td>0.001626</td>
<td>0.000437</td>
<td>0.011600</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1759</td>
<td>chr10:35899143-35899153</td>
<td>S6R691V_her2</td>
<td>0.900000</td>
<td>0.00773</td>
<td>0.003848</td>
<td>0.001626</td>
<td>0.000437</td>
<td>0.011600</td>
</tr>
</tbody>
</table>

<p>80 rows × 8 columns</p>
</div>
</div>
</div>
<div id="cell-97" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># strat 2</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>uniq_reg <span class="op">=</span> high_af_fpsgtmean_all[[<span class="st">'region_id'</span>, <span class="st">'AF_var'</span>, <span class="st">'FPS_scaled_var'</span>]].drop_duplicates()</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="co"># sort the region_id in the filtered high_af dataframe based on descending order of FPS_scaled_var</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>fpsvar_uniqsort <span class="op">=</span> uniq_reg.sort_values(by<span class="op">=</span><span class="st">'FPS_scaled_var'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the region_id from the high_af_fps_var_df_uniqsort dataframe</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>sorted_region_ids <span class="op">=</span> fpsvar_uniqsort[<span class="st">'region_id'</span>]</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Change 'region_id' to a categorical variable with the categories ordered by 'sorted_region_ids'</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>df_copy <span class="op">=</span> high_af_fpsgtmean_all.copy()</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>df_copy[<span class="st">'region_id'</span>] <span class="op">=</span> pd.Categorical(high_af_fpsgtmean_all[<span class="st">'region_id'</span>], categories<span class="op">=</span>sorted_region_ids, ordered<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the DataFrame</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>high_af_fpsgtmean_filt <span class="op">=</span> df_copy[df_copy[<span class="st">'region_id'</span>].isin(sorted_region_ids)]</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort the DataFrame by 'region_id'</span></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>high_af_fpsgtmean_filtered <span class="op">=</span> high_af_fpsgtmean_filt.sort_values(<span class="st">'region_id'</span>)</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>uniq_reg <span class="op">=</span> low_af_fpsgtmean_all[[<span class="st">'region_id'</span>, <span class="st">'AF_var'</span>, <span class="st">'FPS_scaled_var'</span>]].drop_duplicates()</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a><span class="co"># sort the region_id in the filtered high_af dataframe based on descending order of FPS_scaled_var</span></span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>fpsvar_uniqsort <span class="op">=</span> uniq_reg.sort_values(by<span class="op">=</span><span class="st">'FPS_scaled_var'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the region_id from the high_af_fps_var_df_uniqsort dataframe</span></span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>sorted_region_ids <span class="op">=</span> fpsvar_uniqsort[<span class="st">'region_id'</span>]</span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Change 'region_id' to a categorical variable with the categories ordered by 'sorted_region_ids'</span></span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>df_copy <span class="op">=</span> low_af_fpsgtmean_all.copy()</span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a>df_copy[<span class="st">'region_id'</span>] <span class="op">=</span> pd.Categorical(low_af_fpsgtmean_all[<span class="st">'region_id'</span>], categories<span class="op">=</span>sorted_region_ids, ordered<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the DataFrame</span></span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>low_af_fpsgtmean_filt <span class="op">=</span> df_copy[df_copy[<span class="st">'region_id'</span>].isin(sorted_region_ids)]</span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort the DataFrame by 'region_id'</span></span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a>low_af_fpsgtmean_filtered <span class="op">=</span> low_af_fpsgtmean_filt.sort_values(<span class="st">'region_id'</span>)</span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a>uniq_reg <span class="op">=</span> high_af_fpsltmean_all[[<span class="st">'region_id'</span>, <span class="st">'AF_var'</span>, <span class="st">'FPS_scaled_var'</span>]].drop_duplicates()</span>
<span id="cb69-31"><a href="#cb69-31" aria-hidden="true" tabindex="-1"></a><span class="co"># sort the region_id in the filtered high_af dataframe based on descending order of FPS_scaled_var</span></span>
<span id="cb69-32"><a href="#cb69-32" aria-hidden="true" tabindex="-1"></a>fpsvar_uniqsort <span class="op">=</span> uniq_reg.sort_values(by<span class="op">=</span><span class="st">'FPS_scaled_var'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb69-33"><a href="#cb69-33" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the region_id from the high_af_fps_var_df_uniqsort dataframe</span></span>
<span id="cb69-34"><a href="#cb69-34" aria-hidden="true" tabindex="-1"></a>sorted_region_ids <span class="op">=</span> fpsvar_uniqsort[<span class="st">'region_id'</span>]</span>
<span id="cb69-35"><a href="#cb69-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Change 'region_id' to a categorical variable with the categories ordered by 'sorted_region_ids'</span></span>
<span id="cb69-36"><a href="#cb69-36" aria-hidden="true" tabindex="-1"></a>df_copy <span class="op">=</span> high_af_fpsltmean_all.copy()</span>
<span id="cb69-37"><a href="#cb69-37" aria-hidden="true" tabindex="-1"></a>df_copy[<span class="st">'region_id'</span>] <span class="op">=</span> pd.Categorical(high_af_fpsltmean_all[<span class="st">'region_id'</span>], categories<span class="op">=</span>sorted_region_ids, ordered<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb69-38"><a href="#cb69-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the DataFrame</span></span>
<span id="cb69-39"><a href="#cb69-39" aria-hidden="true" tabindex="-1"></a>high_af_fpsltmean_filt <span class="op">=</span> df_copy[df_copy[<span class="st">'region_id'</span>].isin(sorted_region_ids)]</span>
<span id="cb69-40"><a href="#cb69-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort the DataFrame by 'region_id'</span></span>
<span id="cb69-41"><a href="#cb69-41" aria-hidden="true" tabindex="-1"></a>high_af_fpsltmean_filtered <span class="op">=</span> high_af_fpsltmean_filt.sort_values(<span class="st">'region_id'</span>)</span>
<span id="cb69-42"><a href="#cb69-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-43"><a href="#cb69-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-44"><a href="#cb69-44" aria-hidden="true" tabindex="-1"></a>uniq_reg <span class="op">=</span> low_af_fpsltmean_all[[<span class="st">'region_id'</span>, <span class="st">'AF_var'</span>, <span class="st">'FPS_scaled_var'</span>]].drop_duplicates()</span>
<span id="cb69-45"><a href="#cb69-45" aria-hidden="true" tabindex="-1"></a><span class="co"># sort the region_id in the filtered high_af dataframe based on descending order of FPS_scaled_var</span></span>
<span id="cb69-46"><a href="#cb69-46" aria-hidden="true" tabindex="-1"></a>fpsvar_uniqsort <span class="op">=</span> uniq_reg.sort_values(by<span class="op">=</span><span class="st">'FPS_scaled_var'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb69-47"><a href="#cb69-47" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the region_id from the high_af_fps_var_df_uniqsort dataframe</span></span>
<span id="cb69-48"><a href="#cb69-48" aria-hidden="true" tabindex="-1"></a>sorted_region_ids <span class="op">=</span> fpsvar_uniqsort[<span class="st">'region_id'</span>]</span>
<span id="cb69-49"><a href="#cb69-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Change 'region_id' to a categorical variable with the categories ordered by 'sorted_region_ids'</span></span>
<span id="cb69-50"><a href="#cb69-50" aria-hidden="true" tabindex="-1"></a>df_copy <span class="op">=</span> low_af_fpsltmean_all.copy()</span>
<span id="cb69-51"><a href="#cb69-51" aria-hidden="true" tabindex="-1"></a>df_copy[<span class="st">'region_id'</span>] <span class="op">=</span> pd.Categorical(low_af_fpsltmean_all[<span class="st">'region_id'</span>], categories<span class="op">=</span>sorted_region_ids, ordered<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb69-52"><a href="#cb69-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the DataFrame</span></span>
<span id="cb69-53"><a href="#cb69-53" aria-hidden="true" tabindex="-1"></a>low_af_fpsltmean_filt <span class="op">=</span> df_copy[df_copy[<span class="st">'region_id'</span>].isin(sorted_region_ids)]</span>
<span id="cb69-54"><a href="#cb69-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort the DataFrame by 'region_id'</span></span>
<span id="cb69-55"><a href="#cb69-55" aria-hidden="true" tabindex="-1"></a>low_af_fpsltmean_filtered <span class="op">=</span> low_af_fpsltmean_filt.sort_values(<span class="st">'region_id'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, sort the sample_id values per each unique region_id by a specific order. This order is based on the lexicographic order of the sample_id values in the original matrix.</p>
<div id="cell-99" class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get unique sample_id values into a list to define a categorical order</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>datasets <span class="op">=</span> high_nzaf_filtered[<span class="st">'sample_id'</span>].unique().tolist()</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>datasets <span class="op">=</span> <span class="bu">sorted</span>(datasets)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a categorical variable with ordered categories</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>dataset_copy <span class="op">=</span> high_nzaf_filtered.copy()</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>dataset_copy[<span class="st">'sample_id'</span>] <span class="op">=</span> pd.Categorical(dataset_copy[<span class="st">'sample_id'</span>], categories<span class="op">=</span>datasets, ordered<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort 'sample_id' within each 'region_id'</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>high_nzaf_filtsorted <span class="op">=</span> dataset_copy.groupby(<span class="st">'region_id'</span>, sort<span class="op">=</span><span class="va">False</span>, observed<span class="op">=</span><span class="va">False</span>).<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.sort_values(<span class="st">'sample_id'</span>)).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a><span class="co"># do the same for high_af_fpsgtmean_all, low_af_fpsgtmean_all, high_af_fpsltmean_all, low_af_fpsltmean_all</span></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>dataset_copy <span class="op">=</span> high_af_fpsgtmean_filtered.copy()</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>dataset_copy[<span class="st">'sample_id'</span>] <span class="op">=</span> pd.Categorical(dataset_copy[<span class="st">'sample_id'</span>], categories<span class="op">=</span>datasets, ordered<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>high_af_fpsgtmean_filtsorted <span class="op">=</span> dataset_copy.groupby(<span class="st">'region_id'</span>, sort<span class="op">=</span><span class="va">False</span>, observed<span class="op">=</span><span class="va">False</span>).<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.sort_values(<span class="st">'sample_id'</span>)).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>dataset_copy <span class="op">=</span> low_af_fpsgtmean_filtered.copy()</span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>dataset_copy[<span class="st">'sample_id'</span>] <span class="op">=</span> pd.Categorical(dataset_copy[<span class="st">'sample_id'</span>], categories<span class="op">=</span>datasets, ordered<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>low_af_fpsgtmean_filtsorted <span class="op">=</span> dataset_copy.groupby(<span class="st">'region_id'</span>, sort<span class="op">=</span><span class="va">False</span>, observed<span class="op">=</span><span class="va">False</span>).<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.sort_values(<span class="st">'sample_id'</span>)).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>dataset_copy <span class="op">=</span> high_af_fpsltmean_filtered.copy()</span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>dataset_copy[<span class="st">'sample_id'</span>] <span class="op">=</span> pd.Categorical(dataset_copy[<span class="st">'sample_id'</span>], categories<span class="op">=</span>datasets, ordered<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a>high_af_fpsltmean_filtsorted <span class="op">=</span> dataset_copy.groupby(<span class="st">'region_id'</span>, sort<span class="op">=</span><span class="va">False</span>, observed<span class="op">=</span><span class="va">False</span>).<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.sort_values(<span class="st">'sample_id'</span>)).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a>dataset_copy <span class="op">=</span> low_af_fpsltmean_filtered.copy()</span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a>dataset_copy[<span class="st">'sample_id'</span>] <span class="op">=</span> pd.Categorical(dataset_copy[<span class="st">'sample_id'</span>], categories<span class="op">=</span>datasets, ordered<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a>low_af_fpsltmean_filtsorted <span class="op">=</span> dataset_copy.groupby(<span class="st">'region_id'</span>, sort<span class="op">=</span><span class="va">False</span>, observed<span class="op">=</span><span class="va">False</span>).<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.sort_values(<span class="st">'sample_id'</span>)).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-100" class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>high_nzaf_filtsorted.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">region_id</th>
<th data-quarto-table-cell-role="th">sample_id</th>
<th data-quarto-table-cell-role="th">AF</th>
<th data-quarto-table-cell-role="th">FPS</th>
<th data-quarto-table-cell-role="th">FPS_scaled</th>
<th data-quarto-table-cell-role="th">FPS_var</th>
<th data-quarto-table-cell-role="th">FPS_scaled_var</th>
<th data-quarto-table-cell-role="th">AF_var</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>chr16:11915752-11915762</td>
<td>2GAMBDQ_norm</td>
<td>1.000000</td>
<td>0.58711</td>
<td>0.275108</td>
<td>0.033973</td>
<td>0.00537</td>
<td>0.001758</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>chr16:11915752-11915762</td>
<td>98JKPD8_lumA</td>
<td>0.958333</td>
<td>0.94151</td>
<td>0.414623</td>
<td>0.033973</td>
<td>0.00537</td>
<td>0.001758</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>chr16:11915752-11915762</td>
<td>ANAB5F7_basal</td>
<td>1.000000</td>
<td>0.64275</td>
<td>0.329632</td>
<td>0.033973</td>
<td>0.00537</td>
<td>0.001758</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>chr16:11915752-11915762</td>
<td>PU24GB8_lumB</td>
<td>0.921053</td>
<td>0.93861</td>
<td>0.439541</td>
<td>0.033973</td>
<td>0.00537</td>
<td>0.001758</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>chr16:11915752-11915762</td>
<td>S6R691V_her2</td>
<td>0.911765</td>
<td>0.58832</td>
<td>0.292889</td>
<td>0.033973</td>
<td>0.00537</td>
<td>0.001758</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-101" class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>high_af_fpsgtmean_filtsorted.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">region_id</th>
<th data-quarto-table-cell-role="th">sample_id</th>
<th data-quarto-table-cell-role="th">AF</th>
<th data-quarto-table-cell-role="th">FPS</th>
<th data-quarto-table-cell-role="th">FPS_scaled</th>
<th data-quarto-table-cell-role="th">FPS_var</th>
<th data-quarto-table-cell-role="th">FPS_scaled_var</th>
<th data-quarto-table-cell-role="th">AF_var</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>chr16:11915752-11915762</td>
<td>2GAMBDQ_norm</td>
<td>1.000000</td>
<td>0.58711</td>
<td>0.275108</td>
<td>0.033973</td>
<td>0.00537</td>
<td>0.001758</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>chr16:11915752-11915762</td>
<td>98JKPD8_lumA</td>
<td>0.958333</td>
<td>0.94151</td>
<td>0.414623</td>
<td>0.033973</td>
<td>0.00537</td>
<td>0.001758</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>chr16:11915752-11915762</td>
<td>ANAB5F7_basal</td>
<td>1.000000</td>
<td>0.64275</td>
<td>0.329632</td>
<td>0.033973</td>
<td>0.00537</td>
<td>0.001758</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>chr16:11915752-11915762</td>
<td>PU24GB8_lumB</td>
<td>0.921053</td>
<td>0.93861</td>
<td>0.439541</td>
<td>0.033973</td>
<td>0.00537</td>
<td>0.001758</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>chr16:11915752-11915762</td>
<td>S6R691V_her2</td>
<td>0.911765</td>
<td>0.58832</td>
<td>0.292889</td>
<td>0.033973</td>
<td>0.00537</td>
<td>0.001758</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-102" class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>low_af_fpsgtmean_filtsorted.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="69">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">region_id</th>
<th data-quarto-table-cell-role="th">sample_id</th>
<th data-quarto-table-cell-role="th">AF</th>
<th data-quarto-table-cell-role="th">FPS</th>
<th data-quarto-table-cell-role="th">FPS_scaled</th>
<th data-quarto-table-cell-role="th">FPS_var</th>
<th data-quarto-table-cell-role="th">FPS_scaled_var</th>
<th data-quarto-table-cell-role="th">AF_var</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>chr12:453493-453503</td>
<td>2GAMBDQ_norm</td>
<td>0.500000</td>
<td>0.48402</td>
<td>0.226802</td>
<td>0.03456</td>
<td>0.011346</td>
<td>0.000676</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>chr12:453493-453503</td>
<td>98JKPD8_lumA</td>
<td>0.500000</td>
<td>0.53146</td>
<td>0.234045</td>
<td>0.03456</td>
<td>0.011346</td>
<td>0.000676</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>chr12:453493-453503</td>
<td>ANAB5F7_basal</td>
<td>0.500000</td>
<td>0.94811</td>
<td>0.486235</td>
<td>0.03456</td>
<td>0.011346</td>
<td>0.000676</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>chr12:453493-453503</td>
<td>PU24GB8_lumB</td>
<td>0.473684</td>
<td>0.58841</td>
<td>0.275546</td>
<td>0.03456</td>
<td>0.011346</td>
<td>0.000676</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>chr12:453493-453503</td>
<td>S6R691V_her2</td>
<td>0.441176</td>
<td>0.56256</td>
<td>0.280065</td>
<td>0.03456</td>
<td>0.011346</td>
<td>0.000676</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-103" class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>high_af_fpsltmean_filtsorted.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">region_id</th>
<th data-quarto-table-cell-role="th">sample_id</th>
<th data-quarto-table-cell-role="th">AF</th>
<th data-quarto-table-cell-role="th">FPS</th>
<th data-quarto-table-cell-role="th">FPS_scaled</th>
<th data-quarto-table-cell-role="th">FPS_var</th>
<th data-quarto-table-cell-role="th">FPS_scaled_var</th>
<th data-quarto-table-cell-role="th">AF_var</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>chr17:40606941-40606951</td>
<td>2GAMBDQ_norm</td>
<td>0.625000</td>
<td>0.08963</td>
<td>0.041999</td>
<td>0.000965</td>
<td>0.00022</td>
<td>0.005113</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>chr17:40606941-40606951</td>
<td>98JKPD8_lumA</td>
<td>0.681818</td>
<td>0.06397</td>
<td>0.028171</td>
<td>0.000965</td>
<td>0.00022</td>
<td>0.005113</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>chr17:40606941-40606951</td>
<td>ANAB5F7_basal</td>
<td>0.812500</td>
<td>0.01103</td>
<td>0.005657</td>
<td>0.000965</td>
<td>0.00022</td>
<td>0.005113</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>chr17:40606941-40606951</td>
<td>PU24GB8_lumB</td>
<td>0.684211</td>
<td>0.05961</td>
<td>0.027915</td>
<td>0.000965</td>
<td>0.00022</td>
<td>0.005113</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>chr17:40606941-40606951</td>
<td>S6R691V_her2</td>
<td>0.656250</td>
<td>0.08414</td>
<td>0.041888</td>
<td>0.000965</td>
<td>0.00022</td>
<td>0.005113</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-104" class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>low_af_fpsltmean_filtsorted.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="71">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">region_id</th>
<th data-quarto-table-cell-role="th">sample_id</th>
<th data-quarto-table-cell-role="th">AF</th>
<th data-quarto-table-cell-role="th">FPS</th>
<th data-quarto-table-cell-role="th">FPS_scaled</th>
<th data-quarto-table-cell-role="th">FPS_var</th>
<th data-quarto-table-cell-role="th">FPS_scaled_var</th>
<th data-quarto-table-cell-role="th">AF_var</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>chr3:186221446-186221456</td>
<td>2GAMBDQ_norm</td>
<td>0.285714</td>
<td>0.05460</td>
<td>0.025584</td>
<td>0.00074</td>
<td>0.000198</td>
<td>0.016146</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>chr3:186221446-186221456</td>
<td>98JKPD8_lumA</td>
<td>0.409091</td>
<td>0.01650</td>
<td>0.007266</td>
<td>0.00074</td>
<td>0.000198</td>
<td>0.016146</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>chr3:186221446-186221456</td>
<td>ANAB5F7_basal</td>
<td>0.375000</td>
<td>0.07847</td>
<td>0.040243</td>
<td>0.00074</td>
<td>0.000198</td>
<td>0.016146</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>chr3:186221446-186221456</td>
<td>PU24GB8_lumB</td>
<td>0.125000</td>
<td>0.01672</td>
<td>0.007830</td>
<td>0.00074</td>
<td>0.000198</td>
<td>0.016146</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>chr3:186221446-186221456</td>
<td>S6R691V_her2</td>
<td>0.156250</td>
<td>0.02648</td>
<td>0.013183</td>
<td>0.00074</td>
<td>0.000198</td>
<td>0.016146</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-105" class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>dutchfield_colordict <span class="op">=</span> {<span class="st">'S6R691V_her2'</span>: <span class="st">"#e60049"</span>, <span class="st">'ANAB5F7_basal'</span>: <span class="st">"#0bb4ff"</span>, <span class="st">'98JKPD8_lumA'</span>: <span class="st">"#87bc45"</span>, <span class="st">'PU24GB8_lumB'</span>: <span class="st">"#ef9b20"</span>, <span class="st">'2GAMBDQ_norm'</span>: <span class="st">"#b33dc6"</span>}</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>), dpi<span class="op">=</span><span class="dv">300</span>)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="co"># specify subplot</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'AF'</span>, data<span class="op">=</span>high_nzaf_filtsorted, color<span class="op">=</span><span class="st">'whitesmoke'</span>, linecolor<span class="op">=</span><span class="st">'black'</span>, showfliers<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>sns.stripplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'AF'</span>, data<span class="op">=</span>high_nzaf_filtsorted, hue<span class="op">=</span><span class="st">'sample_id'</span>, palette<span class="op">=</span>dutchfield_colordict, size<span class="op">=</span><span class="dv">4</span>, jitter<span class="op">=</span><span class="va">True</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>plt.xticks(ticks<span class="op">=</span>plt.xticks()[<span class="dv">0</span>], labels<span class="op">=</span>[])</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">''</span>)</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>ylabel <span class="op">=</span> textwrap.fill(<span class="st">'AF per site'</span>, width<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(ylabel, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a><span class="co"># place legend outside of the plot</span></span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>plt.legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.01</span>, <span class="dv">1</span>),borderaxespad<span class="op">=</span><span class="dv">0</span>, markerscale<span class="op">=</span><span class="dv">2</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'AF_var'</span>, data<span class="op">=</span>high_nzaf_filtsorted, color<span class="op">=</span><span class="st">'darkslateblue'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>plt.xticks(ticks<span class="op">=</span>plt.xticks()[<span class="dv">0</span>], labels<span class="op">=</span>[])</span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">''</span>)</span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>ylabel <span class="op">=</span> textwrap.fill(<span class="st">'AF variance'</span>, width<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>plt.ylabel(ylabel, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'FPS_scaled'</span>, data<span class="op">=</span>high_nzaf_filtsorted, color<span class="op">=</span><span class="st">'whitesmoke'</span>, linecolor<span class="op">=</span><span class="st">'black'</span>, showfliers<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a>sns.stripplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'FPS_scaled'</span>, data<span class="op">=</span>high_nzaf_filtsorted, hue<span class="op">=</span><span class="st">'sample_id'</span>, palette<span class="op">=</span>dutchfield_colordict, size<span class="op">=</span><span class="dv">4</span>, jitter<span class="op">=</span><span class="va">True</span>, legend<span class="op">=</span><span class="va">False</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb76-24"><a href="#cb76-24" aria-hidden="true" tabindex="-1"></a>plt.xticks(ticks<span class="op">=</span>plt.xticks()[<span class="dv">0</span>], labels<span class="op">=</span>[])</span>
<span id="cb76-25"><a href="#cb76-25" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">''</span>)</span>
<span id="cb76-26"><a href="#cb76-26" aria-hidden="true" tabindex="-1"></a>ylabel <span class="op">=</span> textwrap.fill(<span class="st">'Scaled FPS per site'</span>, width<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb76-27"><a href="#cb76-27" aria-hidden="true" tabindex="-1"></a>plt.ylabel(ylabel, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb76-28"><a href="#cb76-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-29"><a href="#cb76-29" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">4</span>)</span>
<span id="cb76-30"><a href="#cb76-30" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'FPS_scaled_var'</span>, data<span class="op">=</span>high_nzaf_filtsorted, color<span class="op">=</span><span class="st">'darkslateblue'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb76-31"><a href="#cb76-31" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>, fontsize<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb76-32"><a href="#cb76-32" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="ss">f'</span><span class="sc">{</span>motif_id<span class="sc">}</span><span class="ss"> TF binding sites with allelic variants (AF &gt; 0.5 in all subtypes)'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb76-33"><a href="#cb76-33" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Scaled FPS variance'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb76-34"><a href="#cb76-34" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(hspace<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb76-35"><a href="#cb76-35" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb76-36"><a href="#cb76-36" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="variant-freq-analysis-v4_files/figure-html/cell-74-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-106" class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>dutchfield_colordict <span class="op">=</span> {<span class="st">'S6R691V_her2'</span>: <span class="st">"#e60049"</span>, <span class="st">'ANAB5F7_basal'</span>: <span class="st">"#0bb4ff"</span>, <span class="st">'98JKPD8_lumA'</span>: <span class="st">"#87bc45"</span>, <span class="st">'PU24GB8_lumB'</span>: <span class="st">"#ef9b20"</span>, <span class="st">'2GAMBDQ_norm'</span>: <span class="st">"#b33dc6"</span>}</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>), dpi<span class="op">=</span><span class="dv">300</span>)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="co"># specify subplot</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'AF'</span>, data<span class="op">=</span>high_af_fpsgtmean_filtsorted, color<span class="op">=</span><span class="st">'whitesmoke'</span>, linecolor<span class="op">=</span><span class="st">'black'</span>, showfliers<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>sns.stripplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'AF'</span>, data<span class="op">=</span>high_af_fpsgtmean_filtsorted, hue<span class="op">=</span><span class="st">'sample_id'</span>, palette<span class="op">=</span>dutchfield_colordict, size<span class="op">=</span><span class="dv">4</span>, jitter<span class="op">=</span><span class="va">True</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>plt.xticks(ticks<span class="op">=</span>plt.xticks()[<span class="dv">0</span>], labels<span class="op">=</span>[])</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">''</span>)</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>ylabel <span class="op">=</span> textwrap.fill(<span class="st">'AF per site'</span>, width<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(ylabel, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a><span class="co"># place legend outside of the plot</span></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>plt.legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.01</span>, <span class="dv">1</span>),borderaxespad<span class="op">=</span><span class="dv">0</span>, markerscale<span class="op">=</span><span class="dv">2</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'AF_var'</span>, data<span class="op">=</span>high_af_fpsgtmean_filtsorted, color<span class="op">=</span><span class="st">'steelblue'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>plt.xticks(ticks<span class="op">=</span>plt.xticks()[<span class="dv">0</span>], labels<span class="op">=</span>[])</span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">''</span>)</span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a>ylabel <span class="op">=</span> textwrap.fill(<span class="st">'AF variance'</span>, width<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a>plt.ylabel(ylabel, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'FPS_scaled'</span>, data<span class="op">=</span>high_af_fpsgtmean_filtsorted, color<span class="op">=</span><span class="st">'whitesmoke'</span>, linecolor<span class="op">=</span><span class="st">'black'</span>, showfliers<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb77-23"><a href="#cb77-23" aria-hidden="true" tabindex="-1"></a>sns.stripplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'FPS_scaled'</span>, data<span class="op">=</span>high_af_fpsgtmean_filtsorted, hue<span class="op">=</span><span class="st">'sample_id'</span>, palette<span class="op">=</span>dutchfield_colordict, size<span class="op">=</span><span class="dv">4</span>, jitter<span class="op">=</span><span class="va">True</span>, legend<span class="op">=</span><span class="va">False</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb77-24"><a href="#cb77-24" aria-hidden="true" tabindex="-1"></a><span class="co"># plot horizontal line at fps_scaled_global_mean</span></span>
<span id="cb77-25"><a href="#cb77-25" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span>fps_scaled_global_mean, color<span class="op">=</span><span class="st">'black'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb77-26"><a href="#cb77-26" aria-hidden="true" tabindex="-1"></a>plt.xticks(ticks<span class="op">=</span>plt.xticks()[<span class="dv">0</span>], labels<span class="op">=</span>[])</span>
<span id="cb77-27"><a href="#cb77-27" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">''</span>)</span>
<span id="cb77-28"><a href="#cb77-28" aria-hidden="true" tabindex="-1"></a>ylabel <span class="op">=</span> textwrap.fill(<span class="st">'Scaled FPS per site'</span>, width<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb77-29"><a href="#cb77-29" aria-hidden="true" tabindex="-1"></a>plt.ylabel(ylabel, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb77-30"><a href="#cb77-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-31"><a href="#cb77-31" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">4</span>)</span>
<span id="cb77-32"><a href="#cb77-32" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'FPS_scaled_var'</span>, data<span class="op">=</span>high_af_fpsgtmean_filtsorted, color<span class="op">=</span><span class="st">'steelblue'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb77-33"><a href="#cb77-33" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>, fontsize<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb77-34"><a href="#cb77-34" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="ss">f'</span><span class="sc">{</span>motif_id<span class="sc">}</span><span class="ss"> TF binding sites with allelic variants (AF &gt; 0.5 in all subtypes)'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb77-35"><a href="#cb77-35" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Scaled FPS variance'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb77-36"><a href="#cb77-36" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(hspace<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb77-37"><a href="#cb77-37" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb77-38"><a href="#cb77-38" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="variant-freq-analysis-v4_files/figure-html/cell-75-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-107" class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>dutchfield_colordict <span class="op">=</span> {<span class="st">'S6R691V_her2'</span>: <span class="st">"#e60049"</span>, <span class="st">'ANAB5F7_basal'</span>: <span class="st">"#0bb4ff"</span>, <span class="st">'98JKPD8_lumA'</span>: <span class="st">"#87bc45"</span>, <span class="st">'PU24GB8_lumB'</span>: <span class="st">"#ef9b20"</span>, <span class="st">'2GAMBDQ_norm'</span>: <span class="st">"#b33dc6"</span>}</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>), dpi<span class="op">=</span><span class="dv">300</span>)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="co"># specify subplot</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'AF'</span>, data<span class="op">=</span>low_af_fpsgtmean_filtsorted, color<span class="op">=</span><span class="st">'whitesmoke'</span>, linecolor<span class="op">=</span><span class="st">'black'</span>, showfliers<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>sns.stripplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'AF'</span>, data<span class="op">=</span>low_af_fpsgtmean_filtsorted, hue<span class="op">=</span><span class="st">'sample_id'</span>, palette<span class="op">=</span>dutchfield_colordict, size<span class="op">=</span><span class="dv">4</span>, jitter<span class="op">=</span><span class="va">True</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>plt.xticks(ticks<span class="op">=</span>plt.xticks()[<span class="dv">0</span>], labels<span class="op">=</span>[])</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">''</span>)</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>ylabel <span class="op">=</span> textwrap.fill(<span class="st">'AF per site'</span>, width<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(ylabel, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a><span class="co"># place legend outside of the plot</span></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>plt.legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.01</span>, <span class="dv">1</span>),borderaxespad<span class="op">=</span><span class="dv">0</span>, markerscale<span class="op">=</span><span class="dv">2</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'AF_var'</span>, data<span class="op">=</span>low_af_fpsgtmean_filtsorted, color<span class="op">=</span><span class="st">'teal'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>plt.xticks(ticks<span class="op">=</span>plt.xticks()[<span class="dv">0</span>], labels<span class="op">=</span>[])</span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">''</span>)</span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>ylabel <span class="op">=</span> textwrap.fill(<span class="st">'AF variance'</span>, width<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a>plt.ylabel(ylabel, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'FPS_scaled'</span>, data<span class="op">=</span>low_af_fpsgtmean_filtsorted, color<span class="op">=</span><span class="st">'whitesmoke'</span>, linecolor<span class="op">=</span><span class="st">'black'</span>, showfliers<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a>sns.stripplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'FPS_scaled'</span>, data<span class="op">=</span>low_af_fpsgtmean_filtsorted, hue<span class="op">=</span><span class="st">'sample_id'</span>, palette<span class="op">=</span>dutchfield_colordict, size<span class="op">=</span><span class="dv">4</span>, jitter<span class="op">=</span><span class="va">True</span>, legend<span class="op">=</span><span class="va">False</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a><span class="co"># plot horizontal line at fps_scaled_global_mean</span></span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span>fps_scaled_global_mean, color<span class="op">=</span><span class="st">'black'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb78-26"><a href="#cb78-26" aria-hidden="true" tabindex="-1"></a>plt.xticks(ticks<span class="op">=</span>plt.xticks()[<span class="dv">0</span>], labels<span class="op">=</span>[])</span>
<span id="cb78-27"><a href="#cb78-27" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">''</span>)</span>
<span id="cb78-28"><a href="#cb78-28" aria-hidden="true" tabindex="-1"></a>ylabel <span class="op">=</span> textwrap.fill(<span class="st">'Scaled FPS per site'</span>, width<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb78-29"><a href="#cb78-29" aria-hidden="true" tabindex="-1"></a>plt.ylabel(ylabel, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb78-30"><a href="#cb78-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-31"><a href="#cb78-31" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">4</span>)</span>
<span id="cb78-32"><a href="#cb78-32" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'FPS_scaled_var'</span>, data<span class="op">=</span>low_af_fpsgtmean_filtsorted, color<span class="op">=</span><span class="st">'teal'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb78-33"><a href="#cb78-33" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>, fontsize<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb78-34"><a href="#cb78-34" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="ss">f'</span><span class="sc">{</span>motif_id<span class="sc">}</span><span class="ss"> TF binding sites with allelic variants (AF &gt; 0.5 in all subtypes)'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb78-35"><a href="#cb78-35" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Scaled FPS variance'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb78-36"><a href="#cb78-36" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(hspace<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb78-37"><a href="#cb78-37" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb78-38"><a href="#cb78-38" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="variant-freq-analysis-v4_files/figure-html/cell-76-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-108" class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>dutchfield_colordict <span class="op">=</span> {<span class="st">'S6R691V_her2'</span>: <span class="st">"#e60049"</span>, <span class="st">'ANAB5F7_basal'</span>: <span class="st">"#0bb4ff"</span>, <span class="st">'98JKPD8_lumA'</span>: <span class="st">"#87bc45"</span>, <span class="st">'PU24GB8_lumB'</span>: <span class="st">"#ef9b20"</span>, <span class="st">'2GAMBDQ_norm'</span>: <span class="st">"#b33dc6"</span>}</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> textwrap</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>), dpi<span class="op">=</span><span class="dv">300</span>)</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="co"># specify subplot</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'AF'</span>, data<span class="op">=</span>high_af_fpsltmean_filtsorted, color<span class="op">=</span><span class="st">'whitesmoke'</span>, linecolor<span class="op">=</span><span class="st">'black'</span>, showfliers<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>sns.stripplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'AF'</span>, data<span class="op">=</span>high_af_fpsltmean_filtsorted, hue<span class="op">=</span><span class="st">'sample_id'</span>, palette<span class="op">=</span>dutchfield_colordict, size<span class="op">=</span><span class="dv">4</span>, jitter<span class="op">=</span><span class="va">True</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>plt.xticks(ticks<span class="op">=</span>plt.xticks()[<span class="dv">0</span>], labels<span class="op">=</span>[])</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">''</span>)</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>ylabel <span class="op">=</span> textwrap.fill(<span class="st">'AF per site'</span>, width<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>plt.ylabel(ylabel, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a><span class="co"># place legend outside of the plot</span></span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>plt.legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.01</span>, <span class="dv">1</span>),borderaxespad<span class="op">=</span><span class="dv">0</span>, markerscale<span class="op">=</span><span class="dv">2</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'AF_var'</span>, data<span class="op">=</span>high_af_fpsltmean_filtsorted, color<span class="op">=</span><span class="st">'mediumvioletred'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>plt.xticks(ticks<span class="op">=</span>plt.xticks()[<span class="dv">0</span>], labels<span class="op">=</span>[])</span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">''</span>)</span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>ylabel <span class="op">=</span> textwrap.fill(<span class="st">'AF variance'</span>, width<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>plt.ylabel(ylabel, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'FPS_scaled'</span>, data<span class="op">=</span>high_af_fpsltmean_filtsorted, color<span class="op">=</span><span class="st">'whitesmoke'</span>, linecolor<span class="op">=</span><span class="st">'black'</span>, showfliers<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a>sns.stripplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'FPS_scaled'</span>, data<span class="op">=</span>high_af_fpsltmean_filtsorted, hue<span class="op">=</span><span class="st">'sample_id'</span>, palette<span class="op">=</span>dutchfield_colordict, size<span class="op">=</span><span class="dv">4</span>, jitter<span class="op">=</span><span class="va">True</span>, legend<span class="op">=</span><span class="va">False</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true" tabindex="-1"></a><span class="co"># plot horizontal line at fps_scaled_global_median</span></span>
<span id="cb79-26"><a href="#cb79-26" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span>fps_scaled_global_mean, color<span class="op">=</span><span class="st">'black'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb79-27"><a href="#cb79-27" aria-hidden="true" tabindex="-1"></a>plt.xticks(ticks<span class="op">=</span>plt.xticks()[<span class="dv">0</span>], labels<span class="op">=</span>[])</span>
<span id="cb79-28"><a href="#cb79-28" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">''</span>)</span>
<span id="cb79-29"><a href="#cb79-29" aria-hidden="true" tabindex="-1"></a>ylabel <span class="op">=</span> textwrap.fill(<span class="st">'Scaled FPS per site'</span>, width<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb79-30"><a href="#cb79-30" aria-hidden="true" tabindex="-1"></a>plt.ylabel(ylabel, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb79-31"><a href="#cb79-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-32"><a href="#cb79-32" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">4</span>)</span>
<span id="cb79-33"><a href="#cb79-33" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'FPS_scaled_var'</span>, data<span class="op">=</span>high_af_fpsltmean_filtsorted, color<span class="op">=</span><span class="st">'mediumvioletred'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb79-34"><a href="#cb79-34" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>, fontsize<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb79-35"><a href="#cb79-35" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="ss">f'</span><span class="sc">{</span>motif_id<span class="sc">}</span><span class="ss"> TF binding sites with allelic variants (AF &gt; 0.5 in all subtypes)'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb79-36"><a href="#cb79-36" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Scaled FPS variance'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb79-37"><a href="#cb79-37" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(hspace<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb79-38"><a href="#cb79-38" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb79-39"><a href="#cb79-39" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="variant-freq-analysis-v4_files/figure-html/cell-77-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-109" class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>dutchfield_colordict <span class="op">=</span> {<span class="st">'S6R691V_her2'</span>: <span class="st">"#e60049"</span>, <span class="st">'ANAB5F7_basal'</span>: <span class="st">"#0bb4ff"</span>, <span class="st">'98JKPD8_lumA'</span>: <span class="st">"#87bc45"</span>, <span class="st">'PU24GB8_lumB'</span>: <span class="st">"#ef9b20"</span>, <span class="st">'2GAMBDQ_norm'</span>: <span class="st">"#b33dc6"</span>}</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>), dpi<span class="op">=</span><span class="dv">300</span>)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="co"># specify subplot</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'AF'</span>, data<span class="op">=</span>low_af_fpsltmean_filtsorted, color<span class="op">=</span><span class="st">'whitesmoke'</span>, linecolor<span class="op">=</span><span class="st">'black'</span>, showfliers<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>sns.stripplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'AF'</span>, data<span class="op">=</span>low_af_fpsltmean_filtsorted, hue<span class="op">=</span><span class="st">'sample_id'</span>, palette<span class="op">=</span>dutchfield_colordict, size<span class="op">=</span><span class="dv">4</span>, jitter<span class="op">=</span><span class="va">True</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>plt.xticks(ticks<span class="op">=</span>plt.xticks()[<span class="dv">0</span>], labels<span class="op">=</span>[])</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">''</span>)</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>ylabel <span class="op">=</span> textwrap.fill(<span class="st">'AF per site'</span>, width<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(ylabel, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a><span class="co"># place legend outside of the plot</span></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>plt.legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.01</span>, <span class="dv">1</span>),borderaxespad<span class="op">=</span><span class="dv">0</span>, markerscale<span class="op">=</span><span class="dv">2</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'AF_var'</span>, data<span class="op">=</span>low_af_fpsltmean_filtsorted, color<span class="op">=</span><span class="st">'darkolivegreen'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>plt.xticks(ticks<span class="op">=</span>plt.xticks()[<span class="dv">0</span>], labels<span class="op">=</span>[])</span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">''</span>)</span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>ylabel <span class="op">=</span> textwrap.fill(<span class="st">'AF variance'</span>, width<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a>plt.ylabel(ylabel, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'FPS_scaled'</span>, data<span class="op">=</span>low_af_fpsltmean_filtsorted, color<span class="op">=</span><span class="st">'whitesmoke'</span>, linecolor<span class="op">=</span><span class="st">'black'</span>, showfliers<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a>sns.stripplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'FPS_scaled'</span>, data<span class="op">=</span>low_af_fpsltmean_filtsorted, hue<span class="op">=</span><span class="st">'sample_id'</span>, palette<span class="op">=</span>dutchfield_colordict, size<span class="op">=</span><span class="dv">4</span>, jitter<span class="op">=</span><span class="va">True</span>, legend<span class="op">=</span><span class="va">False</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb80-24"><a href="#cb80-24" aria-hidden="true" tabindex="-1"></a><span class="co"># plot horizontal line at fps_scaled_global_mean</span></span>
<span id="cb80-25"><a href="#cb80-25" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span>fps_scaled_global_mean, color<span class="op">=</span><span class="st">'black'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb80-26"><a href="#cb80-26" aria-hidden="true" tabindex="-1"></a>plt.xticks(ticks<span class="op">=</span>plt.xticks()[<span class="dv">0</span>], labels<span class="op">=</span>[])</span>
<span id="cb80-27"><a href="#cb80-27" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">''</span>)</span>
<span id="cb80-28"><a href="#cb80-28" aria-hidden="true" tabindex="-1"></a>ylabel <span class="op">=</span> textwrap.fill(<span class="st">'Scaled FPS per site'</span>, width<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb80-29"><a href="#cb80-29" aria-hidden="true" tabindex="-1"></a>plt.ylabel(ylabel, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb80-30"><a href="#cb80-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-31"><a href="#cb80-31" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">4</span>)</span>
<span id="cb80-32"><a href="#cb80-32" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'FPS_scaled_var'</span>, data<span class="op">=</span>low_af_fpsltmean_filtsorted, color<span class="op">=</span><span class="st">'darkolivegreen'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb80-33"><a href="#cb80-33" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>, fontsize<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb80-34"><a href="#cb80-34" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="ss">f'</span><span class="sc">{</span>motif_id<span class="sc">}</span><span class="ss"> TF binding sites with allelic variants (AF &gt; 0.5 in all subtypes)'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb80-35"><a href="#cb80-35" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Scaled FPS variance'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb80-36"><a href="#cb80-36" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(hspace<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb80-37"><a href="#cb80-37" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb80-38"><a href="#cb80-38" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="variant-freq-analysis-v4_files/figure-html/cell-78-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="strategy-1-subtype-highlighting" class="level4">
<h4 class="anchored" data-anchor-id="strategy-1-subtype-highlighting">Strategy 1: Subtype highlighting</h4>
<p>For FPS distribution there are subtypes that are more represented that others. Let’s try to selectively highlight subtypes which are the maxima per site.</p>
<div id="cell-112" class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the index of the max FPS_scaled value for each region_id</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>idx_max <span class="op">=</span> high_nzaf_filtsorted.groupby(<span class="st">'region_id'</span>, observed<span class="op">=</span><span class="va">True</span>)[<span class="st">'FPS_scaled'</span>].idxmax()</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>idx_min <span class="op">=</span> high_nzaf_filtsorted.groupby(<span class="st">'region_id'</span>, observed<span class="op">=</span><span class="va">True</span>)[<span class="st">'FPS_scaled'</span>].idxmin()</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Select the corresponding rows</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>max_fps_scaled <span class="op">=</span> high_nzaf_filtsorted.loc[idx_max]</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>min_fps_scaled <span class="op">=</span> high_nzaf_filtsorted.loc[idx_min]</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a><span class="co"># do the same for AF</span></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>idx_max_af <span class="op">=</span> high_nzaf_filtsorted.groupby(<span class="st">'region_id'</span>, observed<span class="op">=</span><span class="va">True</span>)[<span class="st">'AF'</span>].idxmax()</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>idx_min_af <span class="op">=</span> high_nzaf_filtsorted.groupby(<span class="st">'region_id'</span>, observed<span class="op">=</span><span class="va">True</span>)[<span class="st">'AF'</span>].idxmin()</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Select the corresponding rows</span></span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>max_af_raw <span class="op">=</span> high_nzaf_filtsorted.loc[idx_max_af]</span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>min_af_raw <span class="op">=</span> high_nzaf_filtsorted.loc[idx_min_af]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-113" class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create masks for the inverse of max and min values</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> <span class="op">~</span>high_nzaf_filtsorted.index.isin(idx_max)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>max_fps_scaled_inv <span class="op">=</span> high_nzaf_filtsorted[mask]</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> <span class="op">~</span>high_nzaf_filtsorted.index.isin(idx_min)</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>min_fps_scaled_inv <span class="op">=</span> high_nzaf_filtsorted[mask]</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a><span class="co"># do the same for AF</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> <span class="op">~</span>high_nzaf_filtsorted.index.isin(idx_max_af)</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>max_af_raw_inv <span class="op">=</span> high_nzaf_filtsorted[mask]</span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> <span class="op">~</span>high_nzaf_filtsorted.index.isin(idx_min_af)</span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>min_af_raw_inv <span class="op">=</span> high_nzaf_filtsorted[mask]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-114" class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create color dictionary</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>color_dict <span class="op">=</span> {<span class="st">'S6R691V_her2'</span>: <span class="st">"#e60049"</span>, <span class="st">'ANAB5F7_basal'</span>: <span class="st">"#0bb4ff"</span>, <span class="st">'98JKPD8_lumA'</span>: <span class="st">"#87bc45"</span>, <span class="st">'PU24GB8_lumB'</span>: <span class="st">"#ef9b20"</span>, <span class="st">'2GAMBDQ_norm'</span>: <span class="st">"#b33dc6"</span>}</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>gray <span class="op">=</span> <span class="st">'lightgray'</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>color_gray_dict <span class="op">=</span> {<span class="st">'S6R691V_her2'</span>: gray, <span class="st">'ANAB5F7_basal'</span>: gray, <span class="st">'98JKPD8_lumA'</span>: gray, <span class="st">'PU24GB8_lumB'</span>: gray, <span class="st">'2GAMBDQ_norm'</span>: gray}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-115" class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>), dpi<span class="op">=</span><span class="dv">300</span>)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="co"># specify subplot</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'AF'</span>, data<span class="op">=</span>high_nzaf_filtsorted, color<span class="op">=</span><span class="st">'whitesmoke'</span>, linecolor<span class="op">=</span><span class="st">'black'</span>, showfliers<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>sns.stripplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'AF'</span>, data<span class="op">=</span>max_af_raw_inv, hue<span class="op">=</span><span class="st">'sample_id'</span>, palette<span class="op">=</span>color_gray_dict, size<span class="op">=</span><span class="dv">4</span>, jitter<span class="op">=</span><span class="va">True</span>, legend<span class="op">=</span><span class="va">False</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>, edgecolor<span class="op">=</span><span class="st">'dimgray'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>sns.stripplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'AF'</span>, data<span class="op">=</span>max_af_raw, hue<span class="op">=</span><span class="st">'sample_id'</span>, palette<span class="op">=</span>color_dict, size<span class="op">=</span><span class="dv">4</span>, jitter<span class="op">=</span><span class="va">True</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>, fontsize<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">''</span>)</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>ylabel <span class="op">=</span> textwrap.fill(<span class="st">'AF Per Site (maxima)'</span>, width<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(ylabel, fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a><span class="co"># place legend outside of the plot</span></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>plt.legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.01</span>, <span class="dv">1</span>),borderaxespad<span class="op">=</span><span class="dv">0</span>, markerscale<span class="op">=</span><span class="dv">2</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'AF_var'</span>, data<span class="op">=</span>high_nzaf_filtsorted, color<span class="op">=</span><span class="st">'darkslateblue'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>, fontsize<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">''</span>)</span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'AF Variance'</span>, fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'FPS_scaled'</span>, data<span class="op">=</span>high_nzaf_filtsorted, color<span class="op">=</span><span class="st">'whitesmoke'</span>, linecolor<span class="op">=</span><span class="st">'black'</span>, showfliers<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>sns.stripplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'FPS_scaled'</span>, data<span class="op">=</span>max_fps_scaled_inv, hue<span class="op">=</span><span class="st">'sample_id'</span>, palette<span class="op">=</span>color_gray_dict, size<span class="op">=</span><span class="dv">4</span>, jitter<span class="op">=</span><span class="va">True</span>, legend<span class="op">=</span><span class="va">False</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>, edgecolor<span class="op">=</span><span class="st">'dimgray'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a>sns.stripplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'FPS_scaled'</span>, data<span class="op">=</span>max_fps_scaled, hue<span class="op">=</span><span class="st">'sample_id'</span>, palette<span class="op">=</span>color_dict, size<span class="op">=</span><span class="dv">4</span>, jitter<span class="op">=</span><span class="va">True</span>, legend<span class="op">=</span><span class="va">False</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>, fontsize<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">''</span>)</span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a>ylabel <span class="op">=</span> textwrap.fill(<span class="st">'Scaled FPS Per Site (maxima)'</span>, width<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a>plt.ylabel(ylabel, fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb84-27"><a href="#cb84-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-28"><a href="#cb84-28" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">4</span>)</span>
<span id="cb84-29"><a href="#cb84-29" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">'region_id'</span>, y<span class="op">=</span><span class="st">'FPS_scaled_var'</span>, data<span class="op">=</span>high_nzaf_filtsorted, color<span class="op">=</span><span class="st">'darkslateblue'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb84-30"><a href="#cb84-30" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>, fontsize<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb84-31"><a href="#cb84-31" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="ss">f'</span><span class="sc">{</span>motif_id<span class="sc">}</span><span class="ss"> TF binding sites with allelic variants (median AF &gt; 0.5)'</span>, fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb84-32"><a href="#cb84-32" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'FPS Variance'</span>, fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb84-33"><a href="#cb84-33" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(hspace<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb84-34"><a href="#cb84-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-35"><a href="#cb84-35" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="variant-freq-analysis-v4_files/figure-html/cell-82-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-116" class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>high_nzaf_filtsorted</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="81">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">region_id</th>
<th data-quarto-table-cell-role="th">sample_id</th>
<th data-quarto-table-cell-role="th">AF</th>
<th data-quarto-table-cell-role="th">FPS</th>
<th data-quarto-table-cell-role="th">FPS_scaled</th>
<th data-quarto-table-cell-role="th">FPS_var</th>
<th data-quarto-table-cell-role="th">FPS_scaled_var</th>
<th data-quarto-table-cell-role="th">AF_var</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>chr16:11915752-11915762</td>
<td>2GAMBDQ_norm</td>
<td>1.000000</td>
<td>0.58711</td>
<td>0.275108</td>
<td>0.033973</td>
<td>0.005370</td>
<td>0.001758</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>chr16:11915752-11915762</td>
<td>98JKPD8_lumA</td>
<td>0.958333</td>
<td>0.94151</td>
<td>0.414623</td>
<td>0.033973</td>
<td>0.005370</td>
<td>0.001758</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>chr16:11915752-11915762</td>
<td>ANAB5F7_basal</td>
<td>1.000000</td>
<td>0.64275</td>
<td>0.329632</td>
<td>0.033973</td>
<td>0.005370</td>
<td>0.001758</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>chr16:11915752-11915762</td>
<td>PU24GB8_lumB</td>
<td>0.921053</td>
<td>0.93861</td>
<td>0.439541</td>
<td>0.033973</td>
<td>0.005370</td>
<td>0.001758</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>chr16:11915752-11915762</td>
<td>S6R691V_her2</td>
<td>0.911765</td>
<td>0.58832</td>
<td>0.292889</td>
<td>0.033973</td>
<td>0.005370</td>
<td>0.001758</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75</td>
<td>chr10:35899143-35899153</td>
<td>2GAMBDQ_norm</td>
<td>0.812500</td>
<td>0.02357</td>
<td>0.011044</td>
<td>0.001626</td>
<td>0.000437</td>
<td>0.011600</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76</td>
<td>chr10:35899143-35899153</td>
<td>98JKPD8_lumA</td>
<td>0.888889</td>
<td>0.01277</td>
<td>0.005624</td>
<td>0.001626</td>
<td>0.000437</td>
<td>0.011600</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">77</td>
<td>chr10:35899143-35899153</td>
<td>ANAB5F7_basal</td>
<td>0.676471</td>
<td>0.10266</td>
<td>0.052649</td>
<td>0.001626</td>
<td>0.000437</td>
<td>0.011600</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">78</td>
<td>chr10:35899143-35899153</td>
<td>PU24GB8_lumB</td>
<td>0.954545</td>
<td>0.01006</td>
<td>0.004711</td>
<td>0.001626</td>
<td>0.000437</td>
<td>0.011600</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">79</td>
<td>chr10:35899143-35899153</td>
<td>S6R691V_her2</td>
<td>0.900000</td>
<td>0.00773</td>
<td>0.003848</td>
<td>0.001626</td>
<td>0.000437</td>
<td>0.011600</td>
</tr>
</tbody>
</table>

<p>80 rows × 8 columns</p>
</div>
</div>
</div>
<div id="cell-117" class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># spearman correlation between AF and FPS_scaled for each subtype in the high_nzaf_filtsorted dataframe; it will tell you that when you rank the FPS values across all sites for one subtype, do you see a similar ranking for AF values across all sites for that subtype</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.stats <span class="im">as</span> stats</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> subtype <span class="kw">in</span> high_nzaf_filtsorted[<span class="st">'sample_id'</span>].unique():</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>    corr_df <span class="op">=</span> high_nzaf_filtsorted[high_nzaf_filtsorted[<span class="st">'sample_id'</span>] <span class="op">==</span> subtype].copy()</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>    correlation, pvalue <span class="op">=</span> stats.spearmanr(corr_df[<span class="st">'FPS_scaled'</span>], corr_df[<span class="st">'AF'</span>])</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(subtype, correlation, pvalue)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2GAMBDQ_norm -0.3008431649277951 0.2575346355188044
98JKPD8_lumA -0.19512456269131023 0.46894749109489353
ANAB5F7_basal 0.008915786895268651 0.9738575664657743
PU24GB8_lumB -0.1577011959909012 0.5596879777607182
S6R691V_her2 -0.19274176740795823 0.47449946914811225</code></pre>
</div>
</div>
<div id="cell-118" class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># quantify the number of filtered sites per sample_id</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>max_af_raw_subset <span class="op">=</span> max_af_raw[[<span class="st">'region_id'</span>, <span class="st">'sample_id'</span>]]</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>max_af_raw_df <span class="op">=</span> max_af_raw_subset.groupby(<span class="st">'sample_id'</span>, observed<span class="op">=</span><span class="va">False</span>)[<span class="st">'region_id'</span>].count().to_frame()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-119" class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>max_af_raw_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="84">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">region_id</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">sample_id</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2GAMBDQ_norm</td>
<td>6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">98JKPD8_lumA</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ANAB5F7_basal</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">PU24GB8_lumB</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">S6R691V_her2</td>
<td>2</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-120" class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>max_fps_scaled_subset <span class="op">=</span> max_fps_scaled[[<span class="st">'region_id'</span>, <span class="st">'sample_id'</span>]]</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>max_fps_scaled_df <span class="op">=</span> max_fps_scaled_subset.groupby(<span class="st">'sample_id'</span>, observed<span class="op">=</span><span class="va">False</span>)[<span class="st">'region_id'</span>].count().to_frame()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-121" class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>max_fps_scaled_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="86">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">region_id</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">sample_id</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2GAMBDQ_norm</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">98JKPD8_lumA</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ANAB5F7_basal</td>
<td>7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">PU24GB8_lumB</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">S6R691V_her2</td>
<td>3</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>